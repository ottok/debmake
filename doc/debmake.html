<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Debmake tutorial</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Debmake tutorial</h1>
<span id="author">Osamu Aoki</span><br />
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="preface">Preface</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <strong>debmake</strong> command is a helper script to generate Debian packaging files.</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command is intended to replace functions offered historically by <strong>deb-make</strong> <span class="footnote"><br />[This new <strong>debmake</strong> package starts its version from <strong>4.0</strong> to avoid version overlaps with its predecessor provided the <strong>deb-make</strong> command.]<br /></span> and <strong>dh_make</strong> commands.  Its features include:</p></div>
<div class="ulist"><ul>
<li>
<p>
keep pre-existing Debian package configuration files untouched
</p>
</li>
<li>
<p>
use of <strong>dh</strong> syntax under the new <strong>debhelper (&gt; 9.0)</strong> package
</p>
<div class="ulist"><ul>
<li>
<p>
extensive check of copyright for <strong>DEP-5</strong> (with <strong>licensecheck</strong>(1) and more)
</p>
</li>
<li>
<p>
substvar supports for binary packages
</p>
</li>
<li>
<p>
support of compiler hardening options
</p>
</li>
</ul></div>
</li>
<li>
<p>
easy packaging command line UI supporting
</p>
<div class="ulist"><ul>
<li>
<p>
non-stop execution with clean results
</p>
</li>
<li>
<p>
direct operation on the tarball archive
</p>
</li>
<li>
<p>
direct operation on the source tree from VCS
</p>
</li>
<li>
<p>
the multiarch Debian package
</p>
</li>
<li>
<p>
the multi binary Debian package
</p>
</li>
<li>
<p>
the non-native Debian packages from the VCS snapshot
</p>
</li>
<li>
<p>
seamless work with <strong>debuild</strong>, <strong>pdebuild</strong>, etc.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">I wrote this <strong>debmake</strong> command because there was no easy command like "<strong>python setup.py bdist_deb</strong>" to create the Debian binary package.  Now "<strong>debmake -d -s -b":python" -i debuild</strong>" does the job for me.</td>
</tr></table>
</div>
<div class="paragraph"><p>I will describe the following to get you started with the <strong>debmake</strong> command.</p></div>
<div class="ulist"><ul>
<li>
<p>
Quick guide for the <strong>debmake</strong> command
</p>
<div class="ulist"><ul>
<li>
<p>
This should be enough for you to get started with the <strong>debmake</strong> command, if you already know the similar <strong>dh_make</strong> command.
</p>
</li>
<li>
<p>
Just browse this section first and come back later, if you are new to the Debian packaging.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Top down view of the Debian packaging
</p>
<div class="ulist"><ul>
<li>
<p>
A rewrite in progress of the &#8220;Debian New Maintainers' Guide&#8221; for the <strong>debmake</strong> command.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Bottom up tutorial for the Debian packaging
</p>
<div class="ulist"><ul>
<li>
<p>
Step-by-step examples of various packaging cases using simple model packages.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Appendix: the <strong>debmake</strong>(1) manpage.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The <strong>/usr/share/doc/debmake/examples.tar.xz</strong> tarball has the sources used for testing the <strong>debmake</strong> command and creating the examples in this document.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">This document focuses to explain how to make a working set of installable Debian binary packages from the upstream source.  Much more details need to be addressed before uploading the package to the Debian archive.</td>
</tr></table>
</div>
<div class="paragraph"><p>Please read the basic Debian documentations together with this manual to generate perfect Debian packages.</p></div>
<div class="ulist"><ul>
<li>
<p>
&#8220;Debian Policy Manual&#8221;&#8201;&#8212;&#8201;"must follow" documentation (<a href="http://www.debian.org/doc/devel-manuals#policy">http://www.debian.org/doc/devel-manuals#policy</a>)
</p>
</li>
<li>
<p>
&#8220;Debian Developer&#8217;s Reference&#8221;&#8201;&#8212;&#8201;"best practice" documentation (<a href="http://www.debian.org/doc/devel-manuals#devref">http://www.debian.org/doc/devel-manuals#devref</a>)
</p>
</li>
<li>
<p>
&#8220;Debian New Maintainers' Guide&#8221;&#8201;&#8212;&#8201;"tutorial" documentation (<a href="http://www.debian.org/doc/devel-manuals#maint-guide">http://www.debian.org/doc/devel-manuals#maint-guide</a>)
</p>
</li>
<li>
<p>
&#8220;Introduction to Debian packaging&#8221;&#8201;&#8212;&#8201;"tutorial" documentation (<a href="http://www.debian.org/doc/devel-manuals#packaging-tutorial">http://www.debian.org/doc/devel-manuals#packaging-tutorial</a>)
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">There is an old Latin saying: &#8220;<strong>fabricando fit faber</strong>&#8221; (&#8220;practice makes perfect&#8221;).  It is highly recommended to practice and experiment with all the steps of Debian packaging with simple packages while reading this tutorial.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quick">Quick guide</h2>
<div class="sectionbody">
<div class="paragraph"><p>This quick guide should be enough for you to get started with the <strong>debmake</strong> command, if you already know the Debian packaging with the <strong>dh_make</strong> command.</p></div>
<div class="paragraph"><p>If you are new to the Debian packaging, do not worry about the details and get the big picture instead.  The more detailed tutorial follows this section.  There is also the <strong>debmake</strong> manpage which explains all the command options.  It is included here in the appendix.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">The <strong>debmake</strong> command only provides good template files. These template files must be manually adjusted to their perfection to comply with the strict quality requirements of the Debian archive.</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="debmake"><strong>debmake</strong></h3>
<div class="paragraph"><p>The <strong>debmake</strong> command is the helper script <span class="footnote"><br />[I am prejudiced.]<br /></span> for the Debian packaging.</p></div>
<div class="ulist"><ul>
<li>
<p>
It makes template files for the Debian packaging in the upstream source based on the <em>type</em> (the <strong>-b</strong> option).
</p>
<div class="ulist"><ul>
<li>
<p>
Use <strong>bin</strong> as the fallback <em>type</em> for the compiled program without its own <em>type</em>.
</p>
</li>
<li>
<p>
Use <strong>script</strong> as the fallback <em>type</em> for the interpreted program without its own <em>type</em>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
It always sets most of the obvious option states and values to reasonable defaults.
</p>
<div class="ulist"><ul>
<li>
<p>
It aims to address typical packaging situation (90% of cases) only.
</p>
</li>
</ul></div>
</li>
<li>
<p>
It always prepares to build the source for the multiarch package, unless <strong>-m</strong> option is explicitly specified.
</p>
</li>
<li>
<p>
It always prepares to build the non-native Debian package with the "<strong>3.0 (quilt)</strong>" format, unless <strong>-n</strong> option is explicitly specified.
</p>
</li>
<li>
<p>
It delegates most of the heavy lifting to its back-end packages: <strong>debhelper</strong>, <strong>dpkg-dev</strong>, <strong>devscripts</strong>, etc.
</p>
</li>
<li>
<p>
It can integrate the whole packaging process from the source archive to the binary package.
</p>
<div class="ulist"><ul>
<li>
<p>
It has the <strong>-a</strong> option to make it work directly with the tarball.
</p>
</li>
<li>
<p>
It has the <strong>-t</strong> and <strong>-d</strong> options to make it work well with the snapshot source in VCS.  These options also allow to make the non-native Debian package from the VCS source tree with the <em>package-version</em><strong>/debian/</strong> directory.  Please note, the non-native Debian package is the normal Debian package.
</p>
</li>
<li>
<p>
It has the <strong>-b</strong> option to make it work with various cases of Debian binary packages.
</p>
</li>
<li>
<p>
It has the <strong>-i</strong> option to run the <strong>debuild</strong> command as its subprocess.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">Make sure to protect the arguments of the <strong>-b</strong>, <strong>-f</strong>, <strong>-l</strong>, and <strong>-w</strong> options from the shell interference by quoting them properly.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="basics">Basics</h3>
<div class="paragraph"><p>Let&#8217;s consider a simple C source following the <a href="http://www.gnu.org/prep/standards/">GNU Coding Standards</a> and <a href="http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">FHS</a>, <em>package-1.0</em><strong>.tar.gz</strong>.</p></div>
<div class="paragraph"><p>The Debian packaging of this <em>package-1.0</em><strong>.tar.gz</strong> into a single binary package can be done with the <strong>debmake</strong> command as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -xvzf package-1.0.tar.gz
 $ cd package-1.0
 $ debmake
 $ debuild</code></pre>
</div></div>
<div class="paragraph"><p>Since manual adjustments of configuration files are skipped, the generated package has problems like description of this autogenerated package lacks meaningful contents, etc.  But this is still a functioning binary package which can be managed by the <strong>dpkg</strong> command.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">The <strong>debuild</strong> command used to make Debian binary packages from the source package in examples may be substituted by the equivalent commands such as <strong>pdebuild</strong> run with the <strong>cowbuilder</strong> back-end.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="xoption">The <strong>-x</strong> option</h3>
<div class="paragraph"><p>The amount of template files generated by the <strong>debmake</strong> command depends on the <strong>-x</strong>[01234] option.</p></div>
<div class="ulist"><ul>
<li>
<p>
The <strong>debmake</strong> command generates more template files with the larger argument number of the <strong>-x</strong> option.
</p>
</li>
<li>
<p>
The <strong>debmake</strong> command is normally invoked without <strong>-x</strong> option and it assumes its <strong>-x</strong> option as follows:
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>-x0</strong> : for the previously Debianized source
</p>
<div class="ulist"><ul>
<li>
<p>
A source tree with any one of the 4 required specification files is considered as Debianized.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<strong>-x1</strong> : for the new single binary package
</p>
</li>
<li>
<p>
<strong>-x2</strong> : for the new multi binary package
</p>
</li>
</ul></div>
</li>
<li>
<p>
The novice users may use <strong>-x3</strong> option for learning.
</p>
<div class="ulist"><ul>
<li>
<p>
With <strong>-x3</strong>, even unusual configuration template files are generated with the extra <strong>.ex</strong> suffix.
</p>
</li>
</ul></div>
</li>
<li>
<p>
See <a href="#emptypkg">[emptypkg]</a> for the cherry-picking of the template files.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">None of the existing configuration files are modified by the <strong>debmake</strong> command.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_shortcut_options_strong_a_strong_strong_i_strong">Shortcut options (<strong>-a</strong>, <strong>-i</strong>)</h3>
<div class="paragraph"><p>The <strong>debmake</strong> command offers 2 shortcut options.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>-a</strong> : open the upstream tarball
</p>
</li>
<li>
<p>
<strong>-i</strong> : execute script to build the binary package
</p>
</li>
</ul></div>
<div class="paragraph"><p>The example in the above <a href="#basics">[basics]</a> can be done simply as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ debmake -a package-1.0.tar.gz -i debuild</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">URL such as "<em>http://www.example.org/DL/package-1.0.tar.gz</em>" may be used for the <strong>-a</strong> option.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">The <strong>debuild</strong> command may be substituted by the equivalent commands such as <strong>pdebuild</strong> etc.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="boption">Binary package</h3>
<div class="paragraph"><p>The <strong>-b</strong> option of the <strong>debmake</strong> command provides intuitive and flexible methods to customize packaging parameters in the <strong>debian/control</strong> file.  It sets the following stanza values.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>Package:</strong>
</p>
</li>
<li>
<p>
<strong>Architecture:</strong>
</p>
</li>
<li>
<p>
<strong>Multi-Arch:</strong>
</p>
</li>
<li>
<p>
<strong>Depends:</strong>
</p>
</li>
<li>
<p>
<strong>Pre-Depends:</strong>
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_the_strong_b_strong_option_syntax">The <strong>-b</strong> option syntax</h4>
<div class="paragraph"><p>Let&#8217;s quote the pertinent part from the <strong>debmake</strong> manpage here.</p></div>
<div class="sidebarblock">
<div class="content">
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>-b</strong> "<em>binarypackage[:type],&#8230;</em>", <strong>--binaryspec</strong> "<em>binarypackage[:type],&#8230;</em>"
</dt>
<dd>
<p>
set binary package specs by the comma separated list of <em>binarypackage:type</em> pairs, e.g., in full form "<strong>foo:bin,foo-doc:doc,libfoo1:lib,libfoo1-dbg:dbg,libfoo-dev:dev</strong>" or in short form "<strong>,-doc,libfoo1,libfoo1-dbg, libfoo-dev</strong>".
</p>
<div class="paragraph"><p>Here, <em>binarypackage</em> is the binary package name; and optional <em>type</em> is chosen from the following <em>type</em> values:</p></div>
<div class="openblock">
<div class="content">
<div class="ulist"><ul>
<li>
<p>
<strong>bin</strong>: C/C++ compiled ELF binary code package (any, foreign) (default, alias: <strong>""</strong>, i.e., <em>null-string</em>)
</p>
</li>
<li>
<p>
<strong>data</strong>: Data (fonts, graphics, &#8230;) package (all, foreign) (alias: <strong>da</strong>)
</p>
</li>
<li>
<p>
<strong>dbg</strong>: Debug symbol package (any, same) (alias: <strong>db</strong>)
</p>
</li>
<li>
<p>
<strong>dev</strong>: Library development package (any, same) (alias: <strong>de</strong>)
</p>
</li>
<li>
<p>
<strong>doc</strong>: Documentation package (all, foreign) (alias: <strong>do</strong>)
</p>
</li>
<li>
<p>
<strong>lib</strong>: Library package (any, same) (alias: <strong>l</strong>)
</p>
</li>
<li>
<p>
<strong>perl</strong>: Perl script package (all, foreign) (alias: <strong>pl</strong>)
</p>
</li>
<li>
<p>
<strong>python</strong>: Python script package (all, foreign) (alias: <strong>py</strong>)
</p>
</li>
<li>
<p>
<strong>python3</strong>: Python3 script package (all, foreign) (alias: <strong>py3</strong>)
</p>
</li>
<li>
<p>
<strong>ruby</strong>: Ruby script package (all, foreign) (alias: <strong>rb</strong>)
</p>
</li>
<li>
<p>
<strong>script</strong>: Shell script package (all, foreign) (alias: <strong>sh</strong>)
</p>
</li>
</ul></div>
</div></div>
<div class="paragraph"><p>The pair values in the parentheses, such as (any, foreign), are the <strong>Architecture</strong> and <strong>Multi-Arch</strong> stanza values set in the <strong>debian/control</strong> file.</p></div>
<div class="paragraph"><p>In many cases, the <strong>debmake</strong> command makes good guess for <em>type</em> from <em>binarypackage</em>.  If <em>type</em> is not obvious, <em>type</em> is set to <strong>bin</strong>.  For example, <strong>libfoo</strong> sets <em>type</em> to <strong>lib</strong>, and <strong>font-bar</strong> sets <em>type</em> to <strong>data</strong>, &#8230;</p></div>
<div class="paragraph"><p>If the source tree contents does not match settings for <em>type</em>, <strong>debmake</strong> warns you.</p></div>
</dd>
</dl></div>
</div></div>
<div class="paragraph"><p>Here are some typical multiarch package split scenarios for the following upstream source examples:</p></div>
<div class="ulist"><ul>
<li>
<p>
a library source <em>libfoo-1.0</em><strong>.tar.gz</strong>
</p>
</li>
<li>
<p>
a tool source <em>bar-1.0</em><strong>.tar.gz</strong> written in a compiled language
</p>
</li>
<li>
<p>
a tool source <em>baz-1.0</em><strong>.tar.gz</strong> written in an interpreted language
</p>
</li>
</ul></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="16%" />
<col width="11%" />
<col width="16%" />
<col width="11%" />
<col width="44%" />
<thead>
<tr>
<th align="left" valign="top"><em>binarypackage</em>   </th>
<th align="left" valign="top"><em>type</em>   </th>
<th align="left" valign="top"><strong>Architecture:</strong></th>
<th align="left" valign="top"><strong>Multi-Arch:</strong>     </th>
<th align="left" valign="top">Package content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><strong>lib</strong><em>foo1</em></p></td>
<td align="left" valign="top"><p class="table"><strong>lib</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">any</p></td>
<td align="left" valign="top"><p class="table">same</p></td>
<td align="left" valign="top"><p class="table">the shared library, co-installable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>lib</strong><em>foo1</em><strong>-dbg</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>dbg</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">any</p></td>
<td align="left" valign="top"><p class="table">same</p></td>
<td align="left" valign="top"><p class="table">the shared library debug symbols, co-installable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>lib</strong><em>foo</em><strong>-dev</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>dev</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">any</p></td>
<td align="left" valign="top"><p class="table">same</p></td>
<td align="left" valign="top"><p class="table">the shared library header files etc., co-installable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>lib</strong><em>foo</em><strong>-tools</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>bin</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">any</p></td>
<td align="left" valign="top"><p class="table">foreign</p></td>
<td align="left" valign="top"><p class="table">the run-time support programs, not co-installable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>lib</strong><em>foo</em><strong>-doc</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>doc</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">all</p></td>
<td align="left" valign="top"><p class="table">foreign</p></td>
<td align="left" valign="top"><p class="table">the shared library documentation files</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>bar</em></p></td>
<td align="left" valign="top"><p class="table"><strong>bin</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">any</p></td>
<td align="left" valign="top"><p class="table">foreign</p></td>
<td align="left" valign="top"><p class="table">the compiled program files, not co-installable</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>bar</em><strong>-doc</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>doc</strong><sup>*</sup></p></td>
<td align="left" valign="top"><p class="table">all</p></td>
<td align="left" valign="top"><p class="table">foreign</p></td>
<td align="left" valign="top"><p class="table">the documentation files for the program</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>baz</em></p></td>
<td align="left" valign="top"><p class="table"><strong>script</strong></p></td>
<td align="left" valign="top"><p class="table">all</p></td>
<td align="left" valign="top"><p class="table">foreign</p></td>
<td align="left" valign="top"><p class="table">the interpreted program files</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>For the cases marked with <sup>*</sup> in the above table, the <em>type</em> values are guessed right from the package names.</p></div>
<div class="paragraph"><p>The default type is the <strong>bin</strong> type which means the compiled ELF binary executables.  This is why the example in <a href="#basics">[basics]</a> does not specify <strong>-b</strong> option.</p></div>
<div class="paragraph"><p>For programs written in other compiled languages, you may need to add its run-time library package dependency to the resulting binary package by adjusting the <strong>Depends:</strong> stanza of the <strong>debian/control</strong> file.</p></div>
<div class="paragraph"><p>The development package for the shared library should depend on it and should contain a version numberless symlink to it. E.g.: <strong>/usr/lib/x86_64-linux-gnu/</strong><em>libfoo</em><strong>.so</strong> &#8594; <em>libfoo</em><strong>.so.</strong><em>1</em></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If any <strong>dbg</strong> type packages are to be generated, they should be made for all <strong>bin</strong> and <strong>lib</strong> type packages.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pythonmod">Python module</h3>
<div class="paragraph"><p>You can generate a single binary Debian package with a reasonable package description directly from the Python module package offered as a tarball <em>pythonmodule-1.0</em><strong>.tar.gz</strong>.  The <strong>-b</strong> option specifying the package type <strong>python</strong> and the <strong>-s</strong> option to copy the package description from the upstream package need to be specified.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ debmake -s -b':python' -a 'pythonmodule-1.0'*.tar.gz* -i debuild</code></pre>
</div></div>
<div class="paragraph"><p>For other interpreted languages with the <strong>-b</strong> option support, specify the pertinent <em>type</em> for the <strong>-b</strong> option.</p></div>
<div class="paragraph"><p>For interpreted languages without the <strong>-b</strong> option support, specify the <strong>script</strong> type instead and add the interpreter package as the dependency of the resulting binary package by adjusting the <strong>debian/control</strong> file.</p></div>
<div class="paragraph"><p>With the <strong>-s</strong> option, the package description is copied from the Python package.</p></div>
</div>
<div class="sect2">
<h3 id="dt-option">Upstream snapshot</h3>
<div class="paragraph"><p>The upstream snapshot from the upstream source tree in VCS can be made with the <strong>-d</strong> option if the upstream supports the "<strong>make dist</strong>" equivalence.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd /path/to/upstream-vcs
 $ debmake -d -i debuild</code></pre>
</div></div>
<div class="paragraph"><p>Alternatively, the same can be made with the <strong>-t</strong> option if the upstream tarball can be made with the <strong>tar</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd /path/to/upstream-vcs
 $ debmake -p package -t -i debuild</code></pre>
</div></div>
<div class="paragraph"><p>Unless you provide the upstream version with the <strong>-u</strong> option or with the <strong>debian/changelog</strong> file, a snapshot upstream version is generated in the 0~%y%m%d%H%M format, e.g., 0~1403012359, from the UTC date and time.</p></div>
<div class="paragraph"><p>If the upstream VCS is hosted in the <em>package/</em> directory instead of the <em>upstream-vcs/</em> directory, the "<strong>-p</strong> <em>package</em>" can be skipped.</p></div>
<div class="paragraph"><p>If the upstream source tree in the VCS contains the <strong>debian/<strong> files, the *debmake</strong> command with either the <strong>-d</strong> option or the <strong>-t</strong> option combined with the <strong>-i</strong> option enables making of the non-native Debian packages from the VCS snapshot while using these *debian/</strong> files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cp -r /path/to/package-0~1403012359/debian/. /path/to/upstream-vcs/debian
 $ dch
   ... update debian/changelog
 $ git add -A .; git commit -m "vcs with debian/*"
 $ debmake -t -p package -i debuild</code></pre>
</div></div>
<div class="paragraph"><p>I call this Debian <strong>non-native</strong> binary package building scheme using the "<strong>debmake -t -i debuild</strong>" command as the <strong>quasi-native</strong> Debian package scheme since it looks like the Debian <strong>native</strong> binary package building scheme by the <strong>debuild</strong> command without the upstream tarball.</p></div>
<div class="paragraph"><p>Use of the <strong>non-native</strong> Debian package helps to ease communication with the downstream distros such as Ubuntu for bug fixes etc.</p></div>
</div>
<div class="sect2">
<h3 id="multic">Multi binary package</h3>
<div class="paragraph"><p>The generation of the functional multi binary package always requires extra manual works than that of the functional single binary package.</p></div>
<div class="paragraph"><p>The Debian packaging of the same <em>package-1.0</em><strong>.tar.gz</strong> (see <a href="#basics">[basics]</a>) into a multi binary package can be done with the <strong>debmake</strong> command as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ debmake -j -a package-1.0.tar.gz</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Check the last lines of <em>package</em><strong>.build-dep.log</strong> to judge build dependencies for <strong>Build-Depends</strong>. (You do not need to list packages used by <strong>debhelper</strong>, <strong>perl</strong>, or <strong>fakeroot</strong> explicitly in <strong>Build-Depends</strong>.  This technique is useful for the generation of the single binary package, too.)
</p>
</li>
<li>
<p>
Check the contents of <em>package</em><strong>.install.log</strong> to identify the install paths for files to decide how you split them into multiple packages.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code> $ rm -rf package-1.0
 $ debmake -b"package1:type1, ..." -a package-1.0.tar.gz
 $ cd package-1.0</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Update <strong>debian/control</strong> and <strong>debian/</strong><em>binarypackage</em><strong>.install</strong> files using the above information.
</p>
</li>
<li>
<p>
Update other <strong>debian/</strong>* files as needed.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code> $ debuild</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Each <em>binarypackage_version-revision_arch</em><strong>.deb</strong> has files specified by the <strong>debian/</strong><em>binarypackage</em><strong>.install</strong> file.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">The binary package name starting with a "<strong>-</strong>" (hyphen) is treated as the abbreviated name and the real binary package name is generated by attaching it to the source package name.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="c-option">Check copyright</h3>
<div class="paragraph"><p>The the <strong>debmake</strong> command can make a summary of the copyright and license for the entire source treeto the standard output.  It also uses the <strong>licensecheck</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -xvzf package-1.0.tar.gz
 $ cd package-1.0
 $ debmake -c | less</code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="topdown">Top down tutorial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="deb">Debian package</h3>
<div class="paragraph"><p>The Debian source package is a set of input files used to build the Debian binary package building and is not a single file.</p></div>
<div class="paragraph"><p>The Debian binary package is an special archive file which holds a set of installable binary data with their associated information.</p></div>
<div class="paragraph"><p>A single Debian source package may generate multiple Debian binary packages defined in the <strong>debian/control</strong> file.</p></div>
<div class="paragraph"><p>The non-native Debian package in the "<strong>3.0 (quilt)</strong>" format is the most normal Debian binary package format.</p></div>
<div class="paragraph"><p>Some people promote to package even programs which have been written especially for Debian in the non-native package format with the above workflow while generating the required tarball without <strong>debian/</strong>* files by oneself in advance. They claim that the use of non-native package format eases communication with the downstream distributions.</p></div>
</div>
<div class="sect2">
<h3 id="workflow">Debian packaging work flow</h3>
<div class="paragraph"><p>The Debian packaging work flow to create the Debian binary package involves generating several specifically named files (see <a href="#name-version">[name-version]</a>) as defined in the &#8220;Debian Policy Manual&#8221;.</p></div>
<div class="paragraph"><p>It can be summarized in 5 steps as follows.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
The upstream tarball is downloaded as the <em>package-version</em><strong>.tar.gz</strong> file.
</p>
</li>
<li>
<p>
The upstream tarball is untared to create many files under the <em>package-version</em><strong>/</strong> directory.
</p>
</li>
<li>
<p>
The upstream tarball is copied (or symlinked) to the particular filename <em>packagename_version</em><strong>.orig.tar.gz</strong>.
</p>
<div class="ulist"><ul>
<li>
<p>
the character separating <em>package</em> and <em>version</em> is changed from <strong>-</strong> (hyphen) to <strong>_</strong> (underscore)
</p>
</li>
<li>
<p>
<strong>.orig</strong> is added in the file extension.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The Debian package specification files are added to the upstream source under the <em>package-version</em><strong>/debian/</strong> directory.
</p>
<div class="ulist"><ul>
<li>
<p>
Required specification files under the <strong>debian/</strong>*:
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>debian/rules</strong>
</dt>
<dd>
<p>
The executable script for building the Debian package (see <a href="#rules">[rules]</a>)
</p>
</dd>
<dt class="hdlist1">
<strong>debian/control</strong>
</dt>
<dd>
<p>
The package configuration file containing the source package name, the source build dependency, the binary package name, the binary dependency, etc. (see <a href="#control">[control]</a>)
</p>
</dd>
<dt class="hdlist1">
<strong>debian/changelog</strong>
</dt>
<dd>
<p>
The Debian package history file defining the upstream package version and the Debian revision in its first line (see <a href="#changelog">[changelog]</a>)
</p>
</dd>
<dt class="hdlist1">
<strong>debian/copyright</strong>
</dt>
<dd>
<p>
The copyright and license summary (see <a href="#copyright">[copyright]</a>)
</p>
</dd>
</dl></div>
</li>
<li>
<p>
Optional specification files under the <strong>debian/</strong>* (see <a href="#debianconf">[debianconf]</a>):
</p>
</li>
<li>
<p>
The <strong>debmake</strong> command invoked in the <em>package-version/</em> directory provides the initial set of these template configuration files (go back to see <a href="#quick">[quick]</a>).
</p>
<div class="ulist"><ul>
<li>
<p>
Required specification files are generated even with the <strong>-x0</strong> option.
</p>
</li>
<li>
<p>
The <strong>debmake</strong> command does not overwrite any existing configuration files.
</p>
</li>
</ul></div>
</li>
<li>
<p>
These files must be manually edited to their perfection according to the &#8220;Debian Policy Manual&#8221; and &#8220;Debian Developers Reference&#8221;.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The <strong>dpkg-buildpackage</strong> command (usually from its wrapper <strong>debuild</strong> or <strong>pdebuild</strong>) is invoked in the <em>package-version/</em> directory to make the Debian source and binary package by invoking the <strong>debian/rules</strong> script.
</p>
<div class="ulist"><ul>
<li>
<p>
The current directory is set as: <strong>$(CURDIR)=</strong><em>/path/to/package-version/</em>
</p>
</li>
<li>
<p>
Create the Debian source package in "<strong>3.0 (quilt)</strong>" format using <strong>dpkg-source</strong>(1)
</p>
<div class="ulist"><ul>
<li>
<p>
<em>package_version</em>.<strong>orig.tar.gz</strong> (copy or symlink of <em>package-version</em>.<strong>tar.gz</strong>)
</p>
</li>
<li>
<p>
<em>package_version-revision</em>.<strong>debian.tar.xz</strong> (tarball of <em>package-version</em>/<strong>debian/</strong>*)
</p>
</li>
<li>
<p>
<em>package_version-revision</em>.<strong>dsc</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
Build the source using "<strong>debian/rules build</strong>" into <strong>$(DESTDIR)</strong>
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>DESTDIR=debian</strong>/<em>binarypackage/</em> (single binary package)
</p>
</li>
<li>
<p>
<strong>DESTDIR=debian/tmp/</strong> (multi binary package)
</p>
</li>
</ul></div>
</li>
<li>
<p>
Create the Debian binary package using <strong>dpkg-deb</strong>(1), and <strong>dpkg-genchanges</strong>(1).
</p>
<div class="ulist"><ul>
<li>
<p>
<em>binarypackage_version-revision_arch</em>.<strong>deb</strong>
</p>
</li>
<li>
<p>
&#8230; (There may be multiple Debian binary package files.)
</p>
</li>
<li>
<p>
<em>package_version-revision_arch</em>.<strong>changes</strong>
</p>
</li>
</ul></div>
</li>
</ul></div>
</li>
</ol></div>
<div class="paragraph"><p>Here, please replace each part of the filename as:</p></div>
<div class="ulist"><ul>
<li>
<p>
the <em>package</em> part with the Debian source package name
</p>
</li>
<li>
<p>
the <em>binarypackage</em> part with the Debian binary package name
</p>
</li>
<li>
<p>
the <em>version</em> part with the upstream version
</p>
</li>
<li>
<p>
the <em>revision</em> part with the Debian revision
</p>
</li>
<li>
<p>
the <em>arch</em> part with the package architecture
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">There is very extensive documentation in <a href="http://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html">Chapter 6. Best Packaging Practices</a> of the &#8220;Debian Developer&#8217;s Reference&#8221;.  Please read it.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="name-version">Package name and version</h3>
<div class="paragraph"><p>If the upstream source comes as <strong>hello-0.9.12.tar.gz</strong>, you can take <strong>hello</strong> as the upstream source package name and <strong>0.9.12</strong> as the upstream version.</p></div>
<div class="paragraph"><p>There  are some limitations for what characters may be used as a part of the Debian package.  The most notable limitation is the prohibition of uppercase letters in the package name.  Here is the summary in the regular expression.</p></div>
<div class="ulist"><ul>
<li>
<p>
Upstream package name (<strong>-p</strong>): [-+.a-z0-9]{2,}
</p>
</li>
<li>
<p>
Binary package name (<strong>-b</strong>): [-+.a-z0-9]{2,}
</p>
</li>
<li>
<p>
Upstream version (<strong>-u</strong>): [0-9][-+.:~a-z0-9A-Z]*
</p>
</li>
<li>
<p>
Debian revision (<strong>-r</strong>): [0-9][+.~a-z0-9A-Z]*
</p>
</li>
</ul></div>
<div class="paragraph"><p>See the exact definition in <a href="http://www.debian.org/doc/debian-policy/ch-controlfields.html">Chapter 5 - Control files and their fields</a> of &#8220;Debian Policy Manual&#8221;.</p></div>
<div class="paragraph"><p>You must adjust the package name and upstream version accordingly for the Debian packaging.</p></div>
<div class="paragraph"><p>In order to manage these information effectively under popular tools such as the <strong>aptitude</strong> command, it is a good idea to keep the length of package name to be equal or less than 30 characters; and the total length of version and revision to be equal or less than 14 characters. <span class="footnote"><br />[For more than 90% of packages, the package name is equal or less than 24 characters; the upstream version is equal or less than 10 characters and the Debian revision is equal or less than 3 characters.]<br /></span></p></div>
<div class="paragraph"><p>If upstream does not use a normal versioning scheme such as <strong>2.30.32</strong> but uses some kind of date such as <strong>11Apr29</strong>, a random codename string, or a VCS hash value as part of the version, make sure to remove them from the upstream version. Such information can be recorded in the <strong>debian/changelog</strong> file. If you need to invent a version string, use the <strong>YYYYMMDD</strong> format such as <strong>20110429</strong> as upstream version. This ensures that dpkg interprets later versions correctly as upgrades. If you need to ensure smooth transition to the normal version scheme such as <strong>0.1</strong> in future, use the <strong>0~YYMMDD</strong> format such as <strong>0~110429</strong> as upstream version, instead.</p></div>
<div class="paragraph"><p>Version strings can be compared using the <strong>dpkg</strong> command as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ dpkg --compare-versions ver1 op ver2</code></pre>
</div></div>
<div class="paragraph"><p>The version comparison rule can be summarized as:</p></div>
<div class="ulist"><ul>
<li>
<p>
Strings are compared from the head to the tail.
</p>
</li>
<li>
<p>
Letters are larger than digits.
</p>
</li>
<li>
<p>
Numbers are compared as integers.
</p>
</li>
<li>
<p>
Letters are compared in ASCII code order.
</p>
</li>
</ul></div>
<div class="paragraph"><p>There are special rules for period (<strong>.</strong>), plus (<strong>+</strong>), and tilde (<strong>~</strong>) characters, as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>0.0 &lt; 0.5 &lt; 0.10 &lt; 0.99 &lt; 1 &lt; 1.0~rc1 &lt; 1.0 &lt; 1.0+b1 &lt; 1.0+nmu1 &lt; 1.1 &lt; 2.0</code></pre>
</div></div>
<div class="paragraph"><p>One tricky case occurs when upstream releases <strong>hello-0.9.12-ReleaseCandidate-99.tar.gz</strong> as the pre-release of <strong>hello-0.9.12.tar.gz</strong>. You need to make sure that the upgrade works properly by renaming the upstream source to <strong>hello-0.9.12~rc99.tar.gz</strong>.</p></div>
</div>
<div class="sect2">
<h3 id="rules"><strong>debian/rules</strong></h3>
<div class="paragraph"><p>The <strong>debian/rules</strong> script is the executable script to build the Debian package.</p></div>
<div class="ulist"><ul>
<li>
<p>
The <strong>debian/rules</strong> script re-targets the upstream build system (see <a href="#build">[build]</a>) to install files in the <strong>$(DESTDIR)</strong> and creates the archive file of the generated files as the <strong>deb</strong> file.
</p>
<div class="ulist"><ul>
<li>
<p>
The <strong>deb</strong> file is used for the binary distribution and installed to the system using the <strong>dpkg</strong> command.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The <strong>dh</strong> command is normally used as the front-end to the build system inside the <strong>debian/rules</strong> script.
</p>
</li>
<li>
<p>
<strong>$(DESTDIR)</strong> path depends on the build type.
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>$(DESTDIR)=debian/</strong><em>binarypackage</em> : when building a single binary package, <em>binarypackage</em>.
</p>
</li>
<li>
<p>
<strong>$(DESTDIR)=debian/tmp</strong> : when building multiple binary packages.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="sect3">
<h4 id="dh">The <strong>dh</strong> command</h4>
<div class="paragraph"><p>The <strong>dh</strong> command from the <strong>debhelper</strong> package with the help from its associated packages functions as the wrapper to the typical upstream build systems and offers us with the uniform access to them by supporting all the Debian policy stipulated targets of the <strong>debian/rules</strong> file.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>dh clean</strong> : clean files in the source tree.
</p>
</li>
<li>
<p>
<strong>dh build</strong> : build the source tree
</p>
</li>
<li>
<p>
<strong>dh build-arch</strong> : build the source tree for architecture dependent packages
</p>
</li>
<li>
<p>
<strong>dh build-indep</strong> : build the source tree for architecture independent packages
</p>
</li>
<li>
<p>
<strong>dh install</strong> : install the binary files to <strong>$(DESTDIR)</strong>
</p>
</li>
<li>
<p>
<strong>dh install-arch</strong> : install the binary files to <strong>$(DESTDIR)</strong> for architecture dependent packages
</p>
</li>
<li>
<p>
<strong>dh install-indep</strong> : install the binary files to <strong>$(DESTDIR)</strong> for architecture independent packages
</p>
</li>
<li>
<p>
<strong>dh binary</strong> : generate the <strong>deb</strong> file
</p>
</li>
<li>
<p>
<strong>dh binary-arch</strong> : generate the <strong>deb</strong> file for architecture dependent packages
</p>
</li>
<li>
<p>
<strong>dh binary-indep</strong> : generate the <strong>deb</strong> file for architecture independent packages
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="simplerules">Simple <strong>debian/rules</strong></h4>
<div class="paragraph"><p>Thanks to this abstraction of the <strong>dh</strong> command <span class="footnote"><br />[This simplicity is available since the <strong>debhelper</strong> version 7.  This document assumes that the <strong>debhelper</strong> version 9 or newer is used.]<br /></span>, the Debian policy compliant <strong>debian/rules</strong> file supporting all the required targets can be written as simple as:</p></div>
<div class="listingblock">
<div class="title">Simple <strong>debian/rules</strong>:</div>
<div class="content">
<pre><code>%:
        dh $@</code></pre>
</div></div>
<div class="paragraph"><p>Essentially, this <strong>dh</strong> command calls all required <strong>dh_</strong>* commands at the right moment.</p></div>
</div>
<div class="sect3">
<h4 id="customrules">Customized <strong>debian/rules</strong></h4>
<div class="paragraph"><p>Flexible customization of the <strong>debian/rules</strong> is realized by adding appropriate <strong>override_dh_</strong>* targets and their rules.</p></div>
<div class="paragraph"><p>Whenever some special operation is required for a certain <strong>dh_</strong><em>foo</em> command invoked by the <strong>dh</strong> command, any automatic execution of it can be overridden by adding the makefile target <strong>override_dh_</strong><em>foo</em> in the <strong>debian/rules</strong> file.</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command creates the initial template file taking advantage of the above simple <strong>debian/rules</strong> while adding some extra customizations for the package hardening, etc.</p></div>
<div class="paragraph"><p>You need to know how underlying build systems work under the hood (see <a href="#build">[build]</a>) to address their irregularities using the package customization.</p></div>
<div class="paragraph"><p>See <a href="#simplepkg">[simplepkg]</a> for the actual simple <strong>debian/rules</strong> generated by the <strong>debmake</strong> command which comes with the commented out parts addressing the hardening via compile options (see <a href="#harden">[harden]</a>) and the the multiarch customization (see <a href="#multiarch">[multiarch]</a>).</p></div>
</div>
</div>
<div class="sect2">
<h3 id="control"><strong>debian/control</strong></h3>
<div class="paragraph"><p>The <strong>debian/control</strong> file is the primary configuration file defining what binary packages are generated.</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command with the <strong>-b</strong> option (see <a href="#boption">[boption]</a>) creates the initial template <strong>debian/control</strong> file with followings:</p></div>
<div class="ulist"><ul>
<li>
<p>
a set of stanza defining the split of the Debian binary package
</p>
</li>
<li>
<p>
a basic set of substvar used for each stanza
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="split">Split of the Debian binary package</h4>
<div class="paragraph"><p>For well behaving build systems, the split of the Debian binary package into small ones can be realized as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
Create binary package entries for all binary packages in the <strong>debian/control</strong> file, and
</p>
</li>
<li>
<p>
List all file paths (relative to <strong>debian/tmp</strong>) in the corresponding <strong>debian/</strong><em>binarypackage</em><strong>.install</strong> files.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Please check examples in this document:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="#multi-ex">[multi-ex]</a> (simple)
</p>
</li>
<li>
<p>
<a href="#multipkg">[multipkg]</a> (detailed)
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="substvar">Substvar</h4>
<div class="paragraph"><p>The <strong>debian/control</strong> file also defines the package dependency in which the <a href="http://www.debian.org/doc/debian-policy/ch-source.html#s-substvars">variable substitutions mechanism</a> (substvar) may be used.  See <strong>deb-substvars</strong>(5).</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command supports following substvars.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>${misc:Depends}</strong> for all binary packages
</p>
</li>
<li>
<p>
<strong>${misc:Pre-Depends}</strong> for all multiarch packages
</p>
</li>
<li>
<p>
<strong>${shlibs:Depends}</strong> for all binary executable and library packages
</p>
</li>
<li>
<p>
<strong>${python:Depends}</strong> for all Python packages
</p>
</li>
<li>
<p>
<strong>${python3:Depends}</strong> for all Python3 packages
</p>
</li>
<li>
<p>
<strong>${perl:Depends}</strong> for all Perl packages
</p>
</li>
<li>
<p>
<strong>${ruby:Depends}</strong> for all Ruby packages
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="binnmu">binNMU safe</h4>
<div class="paragraph"><p>For safe binNMU, the dependency among binary packages from a same source package needs attention if there are both "<strong>Architecture: any</strong>" and "<strong>Architecture: all</strong>" packages involved in it.</p></div>
<div class="ulist"><ul>
<li>
<p>
"<strong>Architecture: any</strong>" package depends on "<strong>Architecture: any</strong>" <em>foo</em> package
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>Depends:</strong> <em>foo</em> <strong>(== ${binary:Version})</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
"<strong>Architecture: any</strong>" package depends on "<strong>Architecture: all</strong>" <em>bar</em> package
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>Depends:</strong> <em>bar</em> <strong>(== ${source:Version}</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
"<strong>Architecture: all</strong>" package depends on "<strong>Architecture: any</strong>" <em>baz</em> package
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>Depends:</strong> <em>baz</em> <strong>(&gt;= ${source:Version})</strong> (no way for a safe dependency but good enough for most cases)
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>The <strong>debian/control</strong> file needs to be be manually adjusted.  See <a href="https://wiki.debian.org/binNMU">binNMU</a>.</p></div>
</div>
<div class="sect3">
<h4 id="libnames">The library package name</h4>
<div class="paragraph"><p>Let&#8217;s assume we have <strong>lib</strong><em>foo-7.0</em><strong>.tar.gz</strong> as the upstream of the <strong>lib</strong><em>foo</em> library.</p></div>
<div class="paragraph"><p>The binary pakage of the the <strong>lib</strong><em>foo</em> library is usually named as <strong>lib</strong><em>foo7</em> with its SONAME major version.</p></div>
<div class="paragraph"><p>When naming the <strong>-dev</strong> package, there are two approaches:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>lib</strong><em>foo</em><strong>-dev</strong> if you support only one <strong>lib</strong><em>foo7</em> only.
</p>
<div class="ulist"><ul>
<li>
<p>
This is good enough if the number of dependent packages are limitted.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<strong>lib</strong><em>foo7</em><strong>-dev</strong> and <strong>lib</strong><em>foo8</em><strong>-dev</strong> if you support both <strong>lib</strong><em>foo7</em> and <strong>lib</strong><em>foo8</em>.
</p>
<div class="ulist"><ul>
<li>
<p>
Both <strong>lib</strong><em>foo7</em><strong>-dev</strong> and <strong>lib</strong><em>foo8</em><strong>-dev</strong> provide <strong>lib</strong><em>foo</em><strong>-dev</strong> to enable the automatic library transition via binNMU.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>See <a href="http://www.debian.org/doc/debian-policy/ch-sharedlibs.html">Chapter 8 - Shared libraries</a> in the &#8220;Debian Policy Manual&#8221;.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="changelog"><strong>debian/changelog</strong></h3>
<div class="paragraph"><p>The <strong>debian/changelog</strong> file records the Debian package history file and defines the upstream package version and the Debian revision in its first line.</p></div>
<div class="paragraph"><p>The <strong>debchange</strong> command (alias <strong>dch</strong>) is used to edit this file.</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command creates the initial template file with the upstream package version and the Debian revision.</p></div>
<div class="paragraph"><p>This is installed in the <strong>/usr/share/doc/</strong><em>binarypackage</em> directory as <strong>changelog.Debian.gz</strong>.</p></div>
<div class="paragraph"><p>The upstream changelog is installed in the <strong>/usr/share/doc/</strong><em>binarypackage</em> directory as <strong>changelog.gz</strong>.</p></div>
<div class="paragraph"><p>The upstream changelog is automatically found by the <strong>dh_installchangelogs</strong> using the case insensitive match of its file name to <strong>changelog</strong>, <strong>changes</strong>, <strong>changelog.txt</strong>, <strong>changes.txt</strong>, <strong>history</strong>, <strong>history.txt</strong>, or <strong>changelog.md</strong> and searched in the <strong>./</strong> <strong>doc/</strong>, or <strong>docs/</strong> directories.</p></div>
</div>
<div class="sect2">
<h3 id="copyright"><strong>debian/copyright</strong></h3>
<div class="paragraph"><p>Debian takes the copyright and license matters very seriously. The &#8220;Debian Policy Manual&#8221; enforces to have summary of them in the <strong>debian/copyright</strong> file in the package.</p></div>
<div class="paragraph"><p>You should format it as the <a href="http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/">machine-readable debian/copyright file</a> (DEP-5).</p></div>
<div class="paragraph"><p>The <strong>debmake</strong> command creates the initial DEP-5 compatible template file by scanning the entire source tree with its internal regular expression.  It also use nternal license checker to clasify each license text. <span class="footnote"><br />[(The <strong>licensecheck</strong> command from the <strong>devscripts</strong> package was referenced to make this internal checker.]<br /></span></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If you find issues with this license checker, please file bug to the <strong>debmake</strong> package with the header part of the problematic file.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="debianconf">Other <strong>debian/</strong>*</h3>
<div class="paragraph"><p>Optional configuration files may be added under the <strong>debian/</strong> directory.  Most of them are to control <strong>dh_</strong>* commands offered by the <strong>debhelper</strong> package but there are some for <strong>lintian</strong> and <strong>gbp</strong> commands.  Here is the alphabetical list of notable optional configuration files.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<em>binarypackage</em><strong>.bug-control</strong>  <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
installed as <strong>usr/share/bug/</strong><em>binarypackage</em><strong>/control</strong> in <em>binarypackage</em>
</p>
<div class="paragraph"><p>See <strong>dh_bugfiles</strong>(1) and <a href="file:///usr/share/doc/reportbug/README.developers.gz">reportbug&#8217;s Features for Developers</a></p></div>
<div class="paragraph"><p>It is the bug control file containing some directions for the bug reporting tool such as redirecting bug report to another package.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.bug-presubj</strong>  <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
installed as <strong>usr/share/bug/</strong><em>binarypackage</em><strong>/presubj</strong> in <em>binarypackage</em>
</p>
<div class="paragraph"><p>See <strong>dh_bugfiles</strong>(1) and <a href="file:///usr/share/doc/reportbug/README.developers.gz">reportbug&#8217;s Features for Developers</a></p></div>
<div class="paragraph"><p>The contents of this file are displayed to the user by the bug reporting tool.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.bug-script</strong>  <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
installed as <strong>usr/share/bug/</strong><em>binarypackage</em> or <strong>usr/share/bug/</strong><em>binarypackage</em><strong>/script</strong> in <em>binarypackage</em>
</p>
<div class="paragraph"><p>See <strong>dh_bugfiles</strong>(1) and <a href="file:///usr/share/doc/reportbug/README.developers.gz">reportbug&#8217;s Features for Developers</a></p></div>
<div class="paragraph"><p>This is the script to be run by the bug reporting program for generating a bug report template.</p></div>
</dd>
<dt class="hdlist1">
<strong>clean</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List files which should be removed but are not cleaned by the <strong>dh_auto_clean</strong> command.
</p>
<div class="paragraph"><p>See <strong>dh_auto_clean</strong>(1) and <strong>dh_clean</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>compat</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
Set the <strong>debhelper</strong> compatibility level (currently, "<strong>9</strong>").
</p>
<div class="paragraph"><p>See &#8220;COMPATIBILITY LEVELS&#8221; in <strong>debhelper</strong>(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.conffile</strong>
</dt>
<dd>
<p>
No need for this file under compat &gt;= 3  since all files in the <strong>etc/</strong> directory are conffiles.
</p>
<div class="paragraph"><p>See <strong>dh_installdeb</strong>(1).</p></div>
<div class="paragraph"><p>If the program you&#8217;re packaging requires every user to modify the configuration files in the <strong>/etc</strong> directory, there are two popular ways to arrange for them to not be conffiles, keeping the <strong>dpkg</strong> command happy and quiet.</p></div>
<div class="ulist"><ul>
<li>
<p>
Create a symlink under the <strong>/etc</strong> directory pointing to a file under the <strong>/var</strong> directory generated by the maintainer scripts.
</p>
</li>
<li>
<p>
Create a file generated by the maintainer scripts under the <strong>/etc</strong> directory.
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.cron.hourly</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into the <strong>etc/cron/hourly/</strong><em>binarypackage</em> file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installcron</strong>(1) and <strong>cron</strong>(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.cron.daily</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into the <strong>etc/cron/daily/</strong><em>binarypackage</em> file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installcron</strong>(1) and <strong>cron</strong>(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.cron.weekly</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into the <strong>etc/cron/weekly/</strong><em>binarypackage</em> file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installcron</strong>(1) and <strong>cron</strong>(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.cron.monthly</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into the <strong>etc/cron/monthly/</strong><em>binarypackage</em> file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installcro</strong>*(1) and <strong>cron</strong>(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.cron.d</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into the <strong>etc/cron.d/</strong><em>binarypackage</em> file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installcron</strong>(1), <strong>cron</strong>(8), and <strong>crontab</strong>(5).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.default</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
If this exists, it is installed into <strong>etc/default/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installinit</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.dirs</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
List directories to be created in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installdirs</strong>(1).</p></div>
<div class="paragraph"><p>Usually, this is not needed since all <strong>dh_install</strong>* commands create required directories automatically.  Use this only when you run into trouble.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.doc-base</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
Installed as the <strong>doc-base</strong> control file in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installdocs</strong>(1) and <a href="file:///usr/share/doc/doc-base/doc-base.html/index.html">Debian doc-base Manual</a> provided by the <strong>doc-base</strong> package.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.docs</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List documentation files to be installed in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installdocs</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.emacsen-compat</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>usr/lib/emacsen-common/packages/compat/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installemacsen</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.emacsen-install</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>usr/lib/emacsen-common/packages/install/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installemacsen</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.emacsen-remove</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>usr/lib/emacsen-common/packages/remove/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installemacsen</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.emacsen-startup</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>usr/lib/emacsen-common/packages/startup/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installemacsen</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.examples</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List example files or directories to be installed into <strong>usr/share/doc/</strong><em>binarypackage</em><strong>/examples/</strong> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installexamples</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>gbp.conf</strong>
</dt>
<dd>
<p>
If this exists, it function as the configuration file for the <strong>gbp</strong> command.
</p>
<div class="paragraph"><p>See <strong>gbp.conf</strong>(5), <strong>gbp</strong>(1), and <strong>git-buildpackage</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.info</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List info files to be installed in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installinfo</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.init</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>etc/init.d/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_installinit</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.install</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List files which should be installed but are not installed by the <strong>dh_auto_install</strong> command.
</p>
<div class="paragraph"><p>See <strong>dh_install</strong>(1) and <strong>dh_auto_install</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>license-examples/</strong>* <sup><strong>-x4</strong></sup>
</dt>
<dd>
<p>
These are copyright file examples.  Use these as the reference for making <strong>copyright</strong> file.
</p>
<div class="paragraph"><p>Please make sure to erase these files.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.links</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List pairs of source and destination files to be symlinked. Each pair should be put on its own line, with the source and destination separated by whitespace.
</p>
<div class="paragraph"><p>See <strong>dh_link</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.lintian-overrides</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
Installed into <strong>usr/share/lintian/overrides/</strong><em>binarypackage</em> in the package build directory. This file is used to suppress erroneous <strong>lintian</strong> diagnostics.
</p>
<div class="paragraph"><p>See <strong>dh_lintian</strong>(1) and <strong>lintian</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>manpage.</strong>* <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
These are template files to make a manpage.
</p>
<div class="paragraph"><p>Debian Policy requires that each program, utility, and function should have an associated manual page included in the same package. Manual pages are written in <strong>nroff</strong>(1).</p></div>
<div class="paragraph"><p>If you are new to making manpage, use <strong>manpage.asciidoc</strong> or <strong>manpage.1</strong> as the starting point.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.manpages</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
List man pages to be installed.
</p>
<div class="paragraph"><p>See <strong>dh_installman</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.menu</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
Debian menu file installed into <strong>usr/share/menu/</strong><em>binarypackage</em> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>menufile</strong>(5) for its format.  See <strong>dh_installmenu</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>NEWS</strong>
</dt>
<dd>
<p>
Installed into <strong>usr/share/doc/</strong><em>binarypackage</em><strong>/NEWS.Debian</strong>.
</p>
<div class="paragraph"><p>See <strong>dh_installchangelogs</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>patches/</strong>*
</dt>
<dd>
<p>
Collection of <strong>-p1</strong> patch files which applied to the upstream source before building the source.
</p>
<div class="paragraph"><p>See dpkg-source(8), <a href="#quilt">[quilt]</a> and <a href="#modpkg">[modpkg]</a>.</p></div>
<div class="paragraph"><p>No files are generated by the <strong>debmake</strong> command.</p></div>
</dd>
<dt class="hdlist1">
<strong>patches/series</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
The application sequence of the <strong>patches/</strong>* patch files.
</p>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.preinst</strong> <sup><strong>-x2</strong></sup>
</dt>
<dt class="hdlist1">
<em>binarypackage</em><strong>.postinst</strong> <sup><strong>-x2</strong></sup>
</dt>
<dt class="hdlist1">
<em>binarypackage</em><strong>.prerm</strong> <sup><strong>-x2</strong></sup>
</dt>
<dt class="hdlist1">
<em>binarypackage</em><strong>.postrm</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
These maintainer scripts are installed into the <strong>DEBIAN</strong> directory.
</p>
<div class="paragraph"><p>Inside the scripts, the token <strong>#DEBHELPER#</strong> is replaced with shell script snippets generated by other <strong>debhelper</strong> commands.</p></div>
<div class="paragraph"><p>See <strong>dh_installdeb</strong>(1) and <a href="http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html">Chapter 6 - Package maintainer scripts and installation procedure</a> of the &#8220;Debian Policy Manual&#8221;.</p></div>
</dd>
<dt class="hdlist1">
<strong>README.Debian</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
Installed into the first binary package listed in the <strong>debian/control</strong> file as <strong>usr/share/doc/</strong><em>binarypackage</em><strong>/README.Debian</strong>.
</p>
<div class="paragraph"><p>See <strong>dh_installdocs</strong>(1).</p></div>
<div class="paragraph"><p>The information specific to the Debian package.</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.service</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
If this exists, it is installed into <strong>lib/systemd/system/</strong><em>binarypackage</em><strong>.service</strong> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_systemd_enable</strong>(1), <strong>dh_systemd_start</strong>(1), and <strong>dh_installinit</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>source/format</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
The Debian package format.
</p>
<div class="ulist"><ul>
<li>
<p>
Use "<strong>3.0 (quilt)</strong>" to make this non-native package (recommended)
</p>
</li>
<li>
<p>
Use "<strong>3.0 (native)</strong>" to make this native package
</p>
<div class="paragraph"><p>See &#8220;SOURCE PACKAGE FORMATS&#8221; in dpkg-source(8).</p></div>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<strong>source.lintian-overrides</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
These files are not installed, but will be scanned by the <strong>lintian</strong> command to provide overrides for the source package.
</p>
<div class="paragraph"><p>See <strong>dh_lintian</strong>(1) and <strong>lintian</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<strong>source/local-options</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
This is not included in the generated source package but committed to the VCS for its smooth operation.
</p>
<div class="paragraph"><p>See &#8220;FILE FORMATS&#8221; in dpkg-source(8).</p></div>
</dd>
<dt class="hdlist1">
<strong>source/options</strong>
</dt>
<dd>
<p>
See the <strong>dpkg-source</strong>(1) manpage under "FILE FORMATS" to learn about the package formats and the patch mechanisms.
</p>
<div class="paragraph"><p>See &#8220;FILE FORMATS&#8221; in dpkg-source(8).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.symbols</strong> <sup><strong>-x2</strong></sup>
</dt>
<dd>
<p>
The symbols files, if present, are passed to the <strong>dpkg-gensymbols</strong> command to be processed and installed.
</p>
<div class="paragraph"><p>See <strong>dh_makeshlibs</strong>(1) and <a href="#symbols">[symbols]</a>..</p></div>
</dd>
<dt class="hdlist1">
<strong>TODO</strong>
</dt>
<dd>
<p>
Installed into the first binary package listed in the <strong>debian/control</strong> file as <strong>usr/share/doc/</strong><em>binarypackage</em><strong>/TODO.Debian</strong>.
</p>
<div class="paragraph"><p>See <strong>dh_installdocs</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.tmpfile</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
If this exists, it is installed into <strong>usr/lib/tmpfiles.d/</strong><em>binarypackage</em><strong>.conf</strong> in <em>binarypackage</em>.
</p>
<div class="paragraph"><p>See <strong>dh_systemd_enable</strong>(1), <strong>dh_systemd_start</strong>(1), and <strong>dh_installinit</strong>(1).</p></div>
</dd>
<dt class="hdlist1">
<em>binarypackage</em><strong>.upstart</strong> <sup><strong>-x3</strong></sup>
</dt>
<dd>
<p>
If this exists, it is installed into etc/init/package.conf in the package build directory.
</p>
<div class="paragraph"><p>See <strong>dh_installinit</strong>(1) and <a href="#emptypkg">[emptypkg]</a>.</p></div>
</dd>
<dt class="hdlist1">
<strong>watch</strong> <sup><strong>-x1</strong></sup>
</dt>
<dd>
<p>
The control file for the <strong>uscan</strong> command to download the latest upstream version
</p>
<div class="paragraph"><p>See <strong>uscan</strong>(1).</p></div>
</dd>
</dl></div>
<div class="paragraph"><p>Here are a few reminders to the above list.</p></div>
<div class="ulist"><ul>
<li>
<p>
For the single binary package, <em>binarypackage</em><strong>.</strong> part of the filename in the list may be removed.
</p>
</li>
<li>
<p>
For the multi binary package, configuration file missing <em>binarypackage</em><strong>.</strong> part of the filename is applied to the first binary package listed in the <strong>debian/control</strong>.
</p>
</li>
<li>
<p>
When there are many binary packages, their configurations can be specified independently by prefixing their name to their configuration filenames such as <em>package-1</em><strong>.install</strong>, <em>package-2</em><strong>.install</strong>, etc.
</p>
</li>
<li>
<p>
Configuration template filenames with <sup><strong>-x1</strong></sup>, <sup><strong>-x2</strong></sup>, <sup><strong>-x3</strong></sup>, or <sup><strong>-x4</strong></sup> in the above mean that they are generated by the <strong>debmake</strong> command with that <strong>-x</strong> option (see <a href="#xoption">[xoption]</a>).
</p>
</li>
<li>
<p>
Some template configuration files may not be created by the <strong>debmake</strong> command. In such cases, you need to create them with an editor.
</p>
</li>
<li>
<p>
Unusual configuration template files generated by the <strong>debmake</strong> command with the extra <strong>.ex</strong> suffix needs to be activated by removing that suffix.
</p>
</li>
<li>
<p>
Unused configuration template files generated by the <strong>debmake</strong> command should be removed.
</p>
</li>
<li>
<p>
Copy configuration template files as needed to the filenames matching their pertinent binary package names.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="custom">Package customization</h3>
<div class="paragraph"><p>There are some upstream sources which does not behave well and you may need to add customization to the build system of those upstream sources.</p></div>
<div class="paragraph"><p>The package should be customized by the least invasive way to address the root cause of the Debian packaging problem.  Your packaging shall be more robust for the future upgrades in this way.  (You should also solve the root cause of the problem and send its patch to the upstream.)</p></div>
<div class="paragraph"><p>Here, there are a few technical approaches to customize the build system:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>patches/</strong>* approach
</p>
</li>
<li>
<p>
<strong>debian/rules</strong> approach
</p>
</li>
<li>
<p>
<strong>debian/</strong><em>bianrypackage</em>.* approach
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="patchaproach"><strong>patches/</strong>* approach</h4>
<div class="paragraph"><p>Modifications to the upstream source before building it can be done by placing the collection of the <strong>-p1</strong> patches in the <strong>patches/</strong> directory and applying them in sequence defined in the  <strong>patches/series</strong> file.</p></div>
<div class="paragraph"><p>There are several methods to prepare <strong>-p1</strong> patches for this.</p></div>
<div class="ulist"><ul>
<li>
<p>
The <strong>diff</strong> command
</p>
</li>
<li>
<p>
The <strong>dquilt</strong> command (alias of the <strong>quilt</strong> command, see <a href="#quilt">[quilt]</a>)
</p>
</li>
<li>
<p>
The <strong>git</strong> command with the <strong>--format-patches</strong> option
</p>
</li>
<li>
<p>
The <strong>git-dpm</strong> command
</p>
</li>
<li>
<p>
Patches used in other distros and floating on the mailing list
</p>
</li>
<li>
<p>
&#8230;
</p>
</li>
</ul></div>
<div class="paragraph"><p>Wherever these patches come from, it is good idea to tag them with <a href="http://dep.debian.net/deps/dep3/">DEP-3</a> compatible header and normalizing it by the <strong>dquilt</strong> command (see <a href="#quilt">[quilt]</a>).  This is also needed for upgrading to the newer upstream source or importing the externally generated security patch.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dquilt push; dquilt refresh
  ... (repeat)
 $ dquilt push; dquilt refresh
File series fully applied, ends at patch ...
 $ pop -a</code></pre>
</div></div>
<div class="paragraph"><p>See  <a href="#modpkg">[modpkg]</a> for example.</p></div>
</div>
<div class="sect3">
<h4 id="rulesapproach"><strong>debian/rules</strong> approach</h4>
<div class="paragraph"><p>The customization to the Debian package build system can be done through the <strong>debian/rules</strong> file.</p></div>
<div class="paragraph"><p>See <a href="#customrules">[customrules]</a>.</p></div>
</div>
<div class="sect3">
<h4 id="configapproach"><strong>debian/</strong><em>binarypackage</em>.* approach</h4>
<div class="paragraph"><p>Add customized configuration files for the <strong>dh_</strong>* command from the <strong>debhelper</strong> package in the <strong>debian/</strong> directory.</p></div>
<div class="paragraph"><p>See <a href="#debianconf">[debianconf]</a>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="build">Upstream build systems</h3>
<div class="paragraph"><p>Upstream build systems are designed to go through several steps to install generated binary files to the system from the source distribution.</p></div>
<div class="sect3">
<h4 id="autotools">Autotools</h4>
<div class="paragraph"><p>Autotools (<strong>autoconf</strong> + <strong>automake</strong>) has 4 steps.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
setup the build system ("<strong>vim configure.ac Makefile.am</strong>" and "<strong>autoreconf -ivf</strong>")
</p>
</li>
<li>
<p>
configure the build system ("<strong>./configure</strong>")
</p>
</li>
<li>
<p>
build the source tree ("<strong>make</strong>")
</p>
</li>
<li>
<p>
install the binary files ("<strong>make install</strong>")
</p>
</li>
</ol></div>
<div class="paragraph"><p>The upstream usually performs the step 1 and builds the upstream tarball for distribution using the "<strong>make dist</strong>" command.   (The generated tarball contains not only the pristine upstream VCS contents but also other generated files.)</p></div>
<div class="paragraph"><p>The package maintainer needs to take care step 2 to 4 at least.  This is realized by the "<strong>dh $@ --with autotools-dev</strong>" command used in the <strong>debian/rules</strong> file.</p></div>
<div class="paragraph"><p>The package maintainer wishes to take care step 1 to 4.  This is realized by the "<strong>dh $@ --with autoreconf</strong>" command used in the <strong>debian/rules</strong> file.  This rebuilds all auto-generated files to the latest version and provides better porting supports.</p></div>
</div>
<div class="sect3">
<h4 id="python">Python distutils</h4>
<div class="paragraph"><p>Python distutils has 3 steps.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
setup and configure the build system ("<strong>vim setup.py</strong>")
</p>
</li>
<li>
<p>
build the source tree ("<strong>python setup.py build</strong>")
</p>
</li>
<li>
<p>
install the binary files ("<strong>python setup.py install</strong>")
</p>
</li>
</ol></div>
<div class="paragraph"><p>The upstream usually performs the step 1 and builds the upstream tarball for distribution using the "<strong>python setup.py sdist</strong>" command.</p></div>
<div class="paragraph"><p>The package maintainer needs to take care step 2.  This is realized simply by the "<strong>dh $@</strong>" command used in the <strong>debian/rules</strong> file, after <strong>jessie</strong>.</p></div>
<div class="paragraph"><p>The situation of other build systems such as CMake are very similar to this Python one.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_information">Debugging information</h3>
<div class="paragraph"><p>The Debian package is build with the debugging information but packaged into the binary package after stripping the debugging information as required by <a href="https://www.debian.org/doc/debian-policy/ch-files.html">Chapter 10 - Files</a> in the &#8220;Debian Policy Manual&#8221;.</p></div>
<div class="paragraph"><p>The debugging information can be packaged separately as the debug packege using the "<strong>dh_strip --dbg-package=</strong><em>package</em>" command in the <strong>override_dh_strip:</strong> target of the <strong>debian/rules</strong> file.</p></div>
<div class="paragraph"><p>The installation path of the debugging information is as follows to enable auto-loading of it by the <strong>gdb</strong> command.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>/usr/lib/debug/.build-id/</strong><em>12/3456&#8230;</em> (compat&gt;=9, for <strong>buildID</strong>=<em>123456&#8230;</em>)
</p>
</li>
<li>
<p>
<strong>/usr/lib/debug/</strong><em>path/to/binary</em> (compat&lt;&lt;9, for <em>/path/to/binary</em>)
</p>
</li>
</ul></div>
<div class="paragraph"><p>See</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html#bpp-dbg">6.7.9. Best practices for debug packages</a> of the &#8220;Debian Developer&#8217;s Reference&#8221;.
</p>
</li>
<li>
<p>
<a href="https://sourceware.org/gdb/current/onlinedocs/gdb/Separate-Debug-Files.html#Separate-Debug-Files">18.2 Debugging Information in Separate Files</a> in the &#8220;Debugging with gdb&#8221;
</p>
</li>
<li>
<p>
<strong>dh_strip</strong>(1)
</p>
</li>
<li>
<p>
<strong>strip</strong>(1)
</p>
</li>
<li>
<p>
<strong>readelf</strong>(1)
</p>
</li>
<li>
<p>
<strong>objcopy</strong>(1)
</p>
</li>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/DebugPackage">DebugPackage</a>
</p>
</li>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/AutomaticDebugPackages">AutomaticDebugPackages</a>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_library_symbols">Library symbols</h3>
<div class="paragraph"><p>The symbols support in the <strong>dpkg</strong> introduced to Debian <strong>lenny</strong> (5.0, May 2009) helps us to manage the backward ABI compatibility of the library package with the same package name.  The <strong>DEBIAN/symbols</strong> file in the binary package provides the minimal version associated to each symbol</p></div>
<div class="paragraph"><p>The oversimplified method for the library packaging is as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
Extract the old <strong>DEBIAN/symbols</strong> file of the immediate previous binary package with the "<strong>dpkg-deb -x</strong>" command.
</p>
</li>
<li>
<p>
Copy it to the <strong>debian/</strong><em>binarypackage</em><strong>.symbols</strong> file.
</p>
<div class="ulist"><ul>
<li>
<p>
If this is the first package, use an empty content file instead.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Build the binary package.
</p>
<div class="ulist"><ul>
<li>
<p>
If the <strong>dpkg-gensymbols</strong> command warns some new symbols:
</p>
<div class="ulist"><ul>
<li>
<p>
Extract the updated <strong>DEBIAN/symbols</strong> file with the "<strong>dpkg-deb -x</strong>" command.
</p>
</li>
<li>
<p>
Trim the Debian revision such as <strong>-1</strong> in it.
</p>
</li>
<li>
<p>
Copy it to the <strong>debian/</strong><em>binarypackage</em><strong>.symbols</strong> file.
</p>
</li>
<li>
<p>
Re-build the binary package.
</p>
</li>
</ul></div>
</li>
<li>
<p>
If the <strong>dpkg-gensymbols</strong> command does not warn new symbols:
</p>
<div class="ulist"><ul>
<li>
<p>
You are done with the library packaging.
</p>
</li>
</ul></div>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>For the details, you should read the following primary references.</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.debian.org/doc/debian-policy/ch-sharedlibs.html#s-sharedlibs-symbols">8.6.3 The symbols system</a> in the &#8220;Debian Policy Manual&#8221;
</p>
</li>
<li>
<p>
<strong>dh_makeshlibs</strong>(1)
</p>
</li>
<li>
<p>
<strong>dpkg-gensymbols</strong>(1)
</p>
</li>
<li>
<p>
<strong>dpkg-shlibdeps</strong>(1)
</p>
</li>
<li>
<p>
<strong>deb-symbols</strong>(5)
</p>
</li>
</ul></div>
<div class="paragraph"><p>Yous should also check:</p></div>
<div class="ulist"><ul>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/UsingSymbolsFiles">UsingSymbolsFiles</a>
</p>
</li>
<li>
<p>
<a href="#librarypkg">[librarypkg]</a>
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">For C++ libraries and other cases where the tracking of the symbols is problematic, follow the &#8220;Debian Policy Manual, 8.6.4 The shlibs system&#8221;, instead.  Please make sure to erase the empty <strong>debian/</strong><em>binarypackage</em><strong>.symbols</strong> file generated by the <strong>debmake</strong> command.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="multiarch">Multiarch</h3>
<div class="paragraph"><p>The multiarch support for cross-architecture installation of binary packages (particularly i386<->amd64, but also other combinations) in the <strong>dpkg</strong> and <strong>apt</strong> packages introduced to Debian <strong>wheezy</strong> (7.0, May 2013) demands us to pay extra attention for the packaging.</p></div>
<div class="paragraph"><p>You should read the following references in detail.</p></div>
<div class="ulist"><ul>
<li>
<p>
Ubuntu wiki <a href="https://wiki.ubuntu.com/MultiarchSpec">MultiarchSpec</a> (upstream)
</p>
</li>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/Multiarch/Implementation">Multiarch/Implementation</a> (Debian situation)
</p>
</li>
</ul></div>
<div class="paragraph"><p>It uses the triplet such as <strong>i386-linux-gnu</strong> and <strong>x86_64-linux-gnu</strong> for the install path of shared libraries. The actual triplet path is dynamically set into <strong>$(DEB_HOST_MULTIARCH)</strong> value by <strong>dpkg-architecture</strong> for each build. For example, the path to install multiarch libraries are changed as follows. (Old special purpose library paths such as <strong>/lib32/</strong> and <strong>/lib64/</strong> are not used any more.)</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="37%" />
<col width="37%" />
<thead>
<tr>
<th align="left" valign="top">Old path       </th>
<th align="left" valign="top">i386 multiarch path            </th>
<th align="left" valign="top">amd64 multiarch path</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">/lib/</p></td>
<td align="left" valign="top"><p class="table">/lib/i386-linux-gnu/</p></td>
<td align="left" valign="top"><p class="table">/lib/x86_64-linux-gnu/</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">/usr/lib/</p></td>
<td align="left" valign="top"><p class="table">/usr/lib/i386-linux-gnu/</p></td>
<td align="left" valign="top"><p class="table">/usr/lib/x86_64-linux-gnu/</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p></p></div>
<div class="paragraph"><p>For other packages with non-supported build systems, you need to manually adjust the install path as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
Call "<strong>DEB_HOST_MULTIARCH ?= $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)</strong>" in the <strong>debian/rules</strong> file to set the <strong>DEB_HOST_MULTIARCH</strong> variable.
</p>
</li>
<li>
<p>
If <strong>./configure</strong> is used in the part of <strong>override_dh_auto_configure</strong> target in <strong>debian/rules</strong>, make sure to replace it with "<strong>dh_auto_configure --</strong>" while retargeting the install path from <strong>/usr/lib/</strong> to <strong>/usr/lib/$(DEB_HOST_MULTIARCH)/</strong>.
</p>
</li>
<li>
<p>
Replace all occurrences of <strong>/usr/lib/</strong> with <strong>/usr/lib/*/</strong> in <strong>debian/</strong><em>foo</em><strong>.install</strong> files.
</p>
</li>
</ul></div>
<div class="paragraph"><p>All files installed simultaneously as the multiarch package to the same file path should have exactly the same file content. You must be careful on differences generated by the data byte order and by the compression algorithm.</p></div>
<div class="paragraph"><p>Please note that <strong>--libexecdir</strong> specifies the default path to install executable programs run by other programs rather than by users. Its Autotools default is <strong>/usr/libexec/</strong> but its Debian default is <strong>/usr/lib/</strong>.</p></div>
</div>
<div class="sect2">
<h3 id="harden">Compiler hardening</h3>
<div class="paragraph"><p>The compiler hardening support spreading for Debian <strong>jessie</strong> (8.0, TBA) demands us to pay extra attention for the packaging.</p></div>
<div class="paragraph"><p>You should read the following references in detail.</p></div>
<div class="ulist"><ul>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/Hardening">Hardening</a>
</p>
</li>
<li>
<p>
Debian wiki <a href="https://wiki.debian.org/HardeningWalkthrough">Hardening Walkthrough</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p>The <strong>debmake</strong> command adds template comments to the <strong>debian/rules</strong> file as needed for <strong>DEB_BUILD_MAINT_OPTIONS</strong>, <strong>DEB_CFLAGS_MAINT_APPEND</strong>, and <strong>DEB_LDFLAGS_MAINT_APPEND</strong> (see <a href="#singlepkg">[singlepkg]</a>).</p></div>
</div>
<div class="sect2">
<h3 id="_tips">Tips</h3>
<div class="sect3">
<h4 id="_basic_tool_list">Basic tool list.</h4>
<div class="paragraph"><p>Please read the <a href="https://www.debian.org/doc/manuals/developers-reference/tools.html">Overview of Debian Maintainer Tools</a> in the &#8220;Debian Developer&#8217;s Reference&#8221;.</p></div>
<div class="paragraph"><p>Few notes (Need BTS)</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>git-builpackage</strong> instead of <strong>cvs-buildpackage</strong>
</p>
</li>
<li>
<p>
<strong>cowbuilder</strong> is normally used with <strong>pbuilder</strong>
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_package_history">Package history</h4>
<div class="paragraph"><p>The best practice for tracking previous package history is as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
Search all previous Debian source package versions for the intended package at the <a href="http://snapshot.debian.org/">snapshot.debian.org</a> archive.
</p>
</li>
<li>
<p>
Use the <strong>dget</strong> command with the URL to the <strong>*.dsc</strong> file to download them.
</p>
</li>
<li>
<p>
Use the <strong>git-import-dscs</strong> command with the <strong>--pristine-tar</strong> option to import all versions at once.
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_utf_8_conversion">UTF-8 conversion</h4>
<div class="paragraph"><p>If upstream documents are encoded in old encoding schemes, converting them to UTF-8 is a good idea.</p></div>
<div class="paragraph"><p>Use iconv(1) to convert encodings of plain text files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>iconv -f latin1 -t utf8 foo_in.txt &gt; foo_out.txt</code></pre>
</div></div>
<div class="paragraph"><p>Use w3m(1) to convert from HTML files to UTF-8 plain text files. When you do this, make sure to execute it under UTF-8 locale.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>LC_ALL=en_US.UTF-8 w3m -o display_charset=UTF-8 \
        -cols 70 -dump -no-graph -T text/html \
        &lt; foo_in.html &gt; foo_out.txt</code></pre>
</div></div>
<div class="paragraph"><p>Run these scripts in the <strong>override_dh_</strong>* target of the <strong>debian/rules</strong> file.</p></div>
</div>
<div class="sect3">
<h4 id="_deb_source_3_0">Deb source 3.0</h4>
<div class="paragraph"><p><a href="https://wiki.debian.org/Projects/DebSrc3.0">ProjectsDebSrc3.0</a></p></div>
</div>
<div class="sect3">
<h4 id="_strong_debdiff_strong"><strong>debdiff</strong></h4>
<div class="paragraph"><p>You can compare file contents in two source Debian packages with the <strong>debdiff</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ debdiff old-package.dsc new-package.dsc</code></pre>
</div></div>
<div class="paragraph"><p>You can also compare file lists in two sets of binary Debian packages with the <strong>debdiff</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ debdiff old-package.changes new-package.changes</code></pre>
</div></div>
<div class="paragraph"><p>These are useful to identify what has been changed in the source packages and to check for inadvertent changes made when updating binary packages, such as unintentionally misplacing or removing files.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bottomup">Bottom up tutorial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="setup">Tool setups</h3>
<div class="paragraph"><p>Although these are not necessary the requirement, basic tool setups are described as below for us to share the common baseline working environment.</p></div>
<div class="sect3">
<h4 id="bash">Setting up <strong>bash</strong></h4>
<div class="paragraph"><p>Various Debian maintenance tools offered by the <strong>devscripts</strong> package and <strong>debmake</strong> recognize your email address and name to use by the shell environment variables <strong>$DEBEMAIL</strong> and <strong>$DEBFULLNAME</strong>.</p></div>
<div class="paragraph"><p>Let&#8217;s set up these by adding the following lines to <strong>~/.bashrc</strong> footnote[This assumes you are using Bash as your login shell. If you use some other login shell such as Z shell, use their corresponding configuration files instead of <strong>~/.bashrc</strong>.].</p></div>
<div class="listingblock">
<div class="title">Add to the <strong>~/.bashrc</strong> file</div>
<div class="content">
<pre><code>DEBEMAIL="your.email.address@example.org"
DEBFULLNAME="Firstname Lastname"
export DEBEMAIL DEBFULLNAME</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="mc">Setting up <strong>mc</strong></h4>
<div class="paragraph"><p>The <strong>mc</strong> offers very easy ways to manage files.  It can open the binary <strong>deb</strong> file to check its content by pressing the Enter key over the binary <strong>deb</strong> file by using the <strong>dpkg-deb</strong> command as its back-end.  Let&#8217;s set up its easy <strong>chdir</strong> support as follows.</p></div>
<div class="listingblock">
<div class="title">Add to the <strong>~/.bashrc</strong> file</div>
<div class="content">
<pre><code># mc related
export HISTCONTROL=ignoreboth
. /usr/lib/mc/mc.sh</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="quilt">Setting up <strong>quilt</strong></h4>
<div class="paragraph"><p>The program <strong>quilt</strong> offers a basic method for recording modifications to the upstream source for the Debian packaging. It&#8217;s useful to have a slightly customized default suitable for the Debian packaging to avoid changing the behavior of the <strong>quilt</strong> command itself.</p></div>
<div class="paragraph"><p>Let&#8217;s create an alias <strong>dquilt</strong> for the Debian packaging by adding the following lines to the <strong>~/.bashrc</strong> file. The second line provides the same shell completion feature of the <strong>quilt</strong> command to the <strong>dquilt</strong> command.</p></div>
<div class="listingblock">
<div class="title">Add to the <strong>~/.bashrc</strong> file</div>
<div class="content">
<pre><code>alias dquilt="quilt --quiltrc=${HOME}/.quiltrc-dpkg"
complete -F _quilt_completion $_quilt_complete_opt dquilt</code></pre>
</div></div>
<div class="paragraph"><p>Then let&#8217;s create <strong>~/.quiltrc-dpkg</strong> as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>d=. ; while [ ! -d $d/debian -a `readlink -e $d` != / ]; do d=$d/..; done
if [ -d $d/debian ] &amp;&amp; [ -z $QUILT_PATCHES ]; then
    # if in Debian packaging tree with unset $QUILT_PATCHES
    QUILT_PATCHES="debian/patches"
    QUILT_PATCH_OPTS="--reject-format=unified"
    QUILT_DIFF_ARGS="-p ab --no-timestamps --no-index --color=auto"
    QUILT_REFRESH_ARGS="-p ab --no-timestamps --no-index"
    QUILT_COLORS="diff_hdr=1;32:diff_add=1;34:diff_rem=1;31:diff_hunk=1;33:diff_ctx=35:diff_cctx=33"
    if ! [ -d $d/debian/patches ]; then mkdir $d/debian/patches; fi
fi</code></pre>
</div></div>
<div class="paragraph"><p>See <strong>quilt</strong>(1) and <a href="file:///usr/share/doc/quilt/quilt.html">How To Survive With Many Patches or Introduction to Quilt</a> on how to use the <strong>quilt</strong> command.</p></div>
</div>
<div class="sect3">
<h4 id="devscripts">Setting up <strong>devscripts</strong></h4>
<div class="paragraph"><p>The <strong>debuild</strong> command runs the <strong>dpkg-buildpackage</strong> and <strong>lintian</strong> commands under the current build environment with the sanitized environment variables to create all the files necessary for uploading a Debian package.</p></div>
<div class="paragraph"><p>Let&#8217;s create <strong>~/.devscripts</strong> as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>DEBSIGN_KEYID='Your_GPG_keyID'
DEBUILD_LINTIAN_OPTS=-i -I --show-overrides</code></pre>
</div></div>
<div class="paragraph"><p>With these, packages are signed by your specified GPG key ID (good for sponsoring packages) and checked in detail by the <strong>lintian</strong> command.</p></div>
</div>
<div class="sect3">
<h4 id="pbuilder">Setting up <strong>pbuilder</strong> + <strong>cowbuilder</strong></h4>
<div class="paragraph"><p>The <strong>pbuilder</strong> package provides the clean room (<strong>chroot</strong>) build environment. The <strong>cowbuilder</strong> package boosts its processing speed. Let&#8217;s customize these packages to make the <strong>pdebuild</strong> command to run with the <strong>cowbuilder and *lintian</strong> commands.</p></div>
<div class="paragraph"><p>Let&#8217;s create <strong>~/.pbuilderrc</strong> as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>AUTO_DEBSIGN=${AUTO_DEBSIGN:-no}
HOOKDIR=/var/cache/pbuilder/hooks
PDEBUILD_PBUILDER=cowbuilder
BUILDRESULT=../</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s create a hook script <strong>/var/cache/pbuilder/hooks/B90lintian</strong> as follows.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#!/bin/sh
set -e
apt-get -y --force-yes install lintian
echo "+++ lintian output +++"
su -c "lintian -i -I --show-overrides /tmp/buildd/*.changes; :" -l pbuilder
echo "+++ end of lintian output +++"</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="git">Setting up <strong>git</strong></h4>
<div class="paragraph"><p>You may wish to set several global configuration in <strong>~/.gitconfig</strong> such as your name and email address used by Git by the following.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git config --global user.name "Name Surname"
$ git config --global user.email yourname@example.com</code></pre>
</div></div>
<div class="paragraph"><p>If you are too used to CVS or Subversion commands, you may wish to set several command aliases by the following.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git config --global alias.ci "commit -a"
$ git config --global alias.co checkout</code></pre>
</div></div>
<div class="paragraph"><p>You can check your global configuration by the following.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git config --global --list</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">It is essential to use the <strong>gitk</strong> command to work with the Git repository.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="gbp">Setting up <strong>git-buildpackage</strong></h4>
<div class="paragraph"><p>You may wish to set several global configuration in <strong>~/.gbp.conf</strong></p></div>
<div class="listingblock">
<div class="content">
<pre><code># Configuration file for "gbp &lt;command&gt;"

[DEFAULT]
# the default build command:
builder = git-pbuilder -i -I -us -uc
# use pristine-tar:
pristine-tar = True
# Use color when on a terminal, alternatives: on/true, off/false or auto
color = auto</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="chroot">Setting up <strong>chroot</strong></h4>
<div class="paragraph"><p>The <strong>pbuilder</strong>, <strong>pdebuild</strong>, <strong>git-pbuilder</strong>, and <strong>gbp</strong> commands used after installing and configuring the <strong>pbuilder</strong>, <strong>cowbuilder</strong>, and <strong>git-buildpackage</strong> packages as described above offer us useful environments to build packages under the <a href="http://en.wikipedia.org/wiki/Chroot">chroot</a>.</p></div>
<div class="paragraph"><p>A clean <strong>sid</strong> distribution chroot environment can be used as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
The chroot filesystem creation command for the <strong>sid</strong> distribution
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>pbuilder create</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
The master chroot filesystem path for the <strong>sid</strong> distribution chroot
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>/var/cache/pbuilder/base.cow</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
The package build command for the <strong>sid</strong> distribution chroot
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>pdebuild</strong>
</p>
</li>
<li>
<p>
<strong>gbp buildpackage</strong>
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>An arbitrary <em>dist</em> distribution environment can be used as follows.</p></div>
<div class="ulist"><ul>
<li>
<p>
The chroot filesystem creation command for the <em>dist</em> distribution
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>pbuilder create --distribution</strong> <em>dist</em>
</p>
</li>
</ul></div>
</li>
<li>
<p>
The master chroot filesystem path for the <em>dist</em> distribution chroot
</p>
<div class="ulist"><ul>
<li>
<p>
path: <strong>/var/cache/pbuilder/base-</strong><em>dist</em><strong>.cow</strong>
</p>
</li>
</ul></div>
</li>
<li>
<p>
The package build command for the <em>dist</em> distribution chroot
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>pdebuild -- --basepath=/var/cache/pbuilder/base-</strong><em>dist</em><strong>.cow</strong>
</p>
</li>
<li>
<p>
<strong>gbp buildpackage --git-dist=</strong><em>dist</em>
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>You need to keep these chroot environments up-to-date using the following <strong>chupgrade</strong> command.</p></div>
<div class="listingblock">
<div class="title">The <strong>chupgrade</strong> command</div>
<div class="content">
<pre><code>#!/bin/sh
# update original tree (not the COW copy)
DIST=$1
ARCH=$2
COW="/var/cache/pbuilder"
if [ "$DIST" = "" ] || [ "$DIST" = "sid" ] ; then
    COW="${COW}/base"
else
    COW="${COW}/base-${DIST}"
fi
if [ "$ARCH" = "" ] || [ "$ARCH" = "amd64" ] ; then
    COW="${COW}.cow"
else
    COW="${COW}-${ARCH}.cow"
fi
echo "update $COW"
sudo cowbuilder --update --basepath $COW</code></pre>
</div></div>
<div class="paragraph"><p>You can create a customized chroot environment by logging into the master chroot system using the following <strong>chlogin</strong> command to a copy of some distribution environment.  (The <strong>chlogin</strong> command is essentially a wrapper command of the <strong>chroot</strong> command.  It also mounts required console device etc.)</p></div>
<div class="listingblock">
<div class="title">The <strong>chlogin</strong> command</div>
<div class="content">
<pre><code>#!/bin/sh
# login to chroot to update original tree (not the COW copy)
DIST=$1
ARCH=$2
COW="/var/cache/pbuilder"
if [ "$DIST" = "" ] || [ "$DIST" = "sid" ] ; then
    COW="${COW}/base"
else
    COW="${COW}/${DIST}"
fi
if [ "$ARCH" = "" ] || [ "$ARCH" = "amd64" ] ; then
    COW="${COW}.cow"
else
    COW="${COW}-${ARCH}.cow"
fi
echo "login to $COW (overwrite non-COW mode)"
sudo pbuilder --login --no-targz --buildplace $COW</code></pre>
</div></div>
<div class="paragraph"><p>If you wish to build a stable security update package etc. under a custom environment with some pre-loaded packages, this <strong>chlogin</strong> command is quite handy.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="singlepkg">Single binary package</h3>
<div class="paragraph"><p>For the case of creating a single binary Debian package from the <strong>$(DESTDIR)</strong> and Filesystem Hierarchy Standard (FHS) supporting source, the packaging process can be practically automatic if you only wish to make it for your local use and do not worry about details of the Debian Policy.</p></div>
<div class="paragraph"><p>Let&#8217;s assume you have a simple upstream source tarball <strong>hello-c-1.0.tar.gz</strong>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ wget http://www.example.org/download/hello-c-1.0.tar.gz
 ...</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s untar it.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -xvzmf hello-c-1.0.tar.gz
hello-c-1.0/
hello-c-1.0/Makefile
hello-c-1.0/hello.c</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s inspect files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tree
.
|-- hello-c-1.0
|   |-- hello.c
|   `-- Makefile
`-- hello-c-1.0.tar.gz

1 directory, 3 files</code></pre>
</div></div>
<div class="paragraph"><p><strong>Makefile</strong> supports <strong>$(DESTDIR)</strong>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cat hello-c-1.0/Makefile
all: hello

hello: hello.c
        gcc -Wall -o hello hello.c

install: hello
        install -D hello $(DESTDIR)/usr/bin/hello

clean:
        -rm -f hello

distclean: clean

.PHONY: all install clean distclean</code></pre>
</div></div>
<div class="paragraph"><p>The C source <strong>hello.c</strong> is a very simple one.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cat hello-c-1.0/hello.c
#include &lt;stdio.h&gt;
int
main()
{
        printf("Hello, Debian packager!\n");
        return 0;
}</code></pre>
</div></div>
<div class="paragraph"><p>You create a non-native Debian package source tree from this upstream example using the <strong>debmake</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-1.0
 $ debmake
I: set parameters
I: sanity check of parameters
I: pkg="hello-c", ver="1.0", rev="1"
I: *** start packaging in "hello-c-1.0". ***
I: provide hello-c_1.0.orig.tar.gz for non-native Debian package
I: pwd = "/path/to"
I: $ ln -sf hello-c-1.0.tar.gz hello-c_1.0.orig.tar.gz
I: pwd = "/path/to/hello-c-1.0"
I: parse binary package settings:
I: binary package=hello-c Type=bin / Arch=any M-A=foreign
I: analyze the source tree
I: build_type = make
I: 100 %, ext = c
I: make debian/* template files
I: single binary package
I: debmake -x "1" ...
I: creating =&gt; debian/control
I: creating =&gt; debian/copyright
I: creating =&gt; debian/changelog
I: creating =&gt; debian/rules
I: creating =&gt; debian/compat
I: creating =&gt; debian/watch
I: creating =&gt; debian/README.Debian
I: creating =&gt; debian/source/format
I: creating =&gt; debian/source/local-options
I: creating =&gt; debian/patches/series
I: run "debmake -x2" to get more template files
I: $ wrap-and-sort</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect generated template files.</p></div>
<div class="listingblock">
<div class="title"><strong>debian/rules</strong>:</div>
<div class="content">
<pre><code> $ cat debian/rules
#!/usr/bin/make -f
# See debhelper(7) (uncomment to enable)
# output every command that modifies files on the build system.
#DH_VERBOSE = 1

# In case you want to add more flags to the defaults, use
# the followings to harden via compiler options
# see FEATURE AREAS in dpkg-buildflags(1))
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all
# see ENVIRONMENT in dpkg-buildflags(1))
# package maintainers to append CFLAGS
#export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
# package maintainers to append LDFLAGS
#export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed



# main packaging script based on dh7 syntax
%:
        dh $@

# debmake generated override targets
# See dpkg-architecture(1) to set multiarch path as needed.
#DEB_HOST_MULTIARCH ?= $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)
#
# This is example for Cmake (See http://bugs.debian.org/641051 )
#override_dh_auto_configure:
#       dh_auto_configure -- \
#       -DCMAKE_LIBRARY_PATH=$(DEB_HOST_MULTIARCH)</code></pre>
</div></div>
<div class="paragraph"><p>This is essentially the standard <strong>debian/rules</strong> file with the <strong>dh</strong> command. (There are some commented out contents for you to customize it.)</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">Configuration files used by the <strong>dh_</strong>* commands from the <strong>debhelper</strong> package usually treat <strong>#</strong> as the start of the comment line.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title"><strong>debian/control</strong>:</div>
<div class="content">
<pre><code> $ cat debian/control
Source: hello-c
Section: unknown
Priority: extra
Maintainer: "Firstname Lastname" &lt;email.address@example.org&gt;
Build-Depends: debhelper (&gt;=9)
Standards-Version: 3.9.5
Homepage: &lt;insert the upstream URL, if relevant&gt;

Package: hello-c
Architecture: any
Multi-Arch: foreign
Depends: ${misc:Depends}, ${shlibs:Depends}
Description: auto-generated package by debmake
 This Debian binary package was auto-generated by the
 debmake(1) command provided by the debmake package.
 .
 ===== This comes from the unmodified template file =====
 .
 Please edit this template file (debian/control) and other package files...
 (debian/*) to make them meet all the requirements of the Debian Policy
 before uploading this package to the Debian archive.
 .
 See
  * http://www.debian.org/doc/manuals/maint-guide/dreq.en.html#control
  * http://www.debian.org/doc/manuals/developers-reference/best-pkging-p...
 .
 The synopsis description at the top should be about 60 characters and
 written as a phrase.  No extra capital letters or a final period.  No
 articles  "a", "an", or "the".
 .
 The package description for general-purpose applications should be
 written for a less technical user.  This means that we should avoid
 jargon.  GNOME or KDE is fine but GTK+ is probably not.
 .
 Use the canonical forms of words:
  * Use X Window System, X11, or X; not X Windows, X-Windows, or X Windo...
  * Use GTK+, not GTK or gtk.
  * Use GNOME, not Gnome.
  * Use PostScript, not Postscript or postscript.</code></pre>
</div></div>
<div class="paragraph"><p>Please note that the <strong>debmake</strong> command is run with the <strong>-x21</strong> option as the default for the new single binary package.</p></div>
<div class="paragraph"><p>Since this is the ELF binary executable package (<em>type</em>=<strong>bin</strong>), it is set to "<strong>Architecture: any</strong>" and "<strong>Multi-Arch: foreign</strong>".  Also, required <strong>substvar</strong> parameters are set as "<strong>Depends: ${shlibs:Depends}, ${misc:Depends}</strong>" by the <strong>debmake</strong> command.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Please note this <strong>debian/control</strong> file uses the RFC-822 style as documented in the &#8220;Debian Policy Manual: 5.2 Source package control files&#8201;&#8212;&#8201;debian/control&#8221;. The use of the empty line and the leading space are significant.</td>
</tr></table>
</div>
<div class="paragraph"><p>There are several other template files under the <strong>debian/</strong> directory.</p></div>
<div class="listingblock">
<div class="title">The source tree after the basic <strong>debmake</strong> execution.</div>
<div class="content">
<pre><code> $ cd ..
 $ tree
.
|-- hello-c-1.0
|   |-- debian
|   |   |-- changelog
|   |   |-- compat
|   |   |-- control
|   |   |-- copyright
|   |   |-- patches
|   |   |   `-- series
|   |   |-- README.Debian
|   |   |-- rules
|   |   |-- source
|   |   |   |-- format
|   |   |   `-- local-options
|   |   `-- watch
|   |-- hello.c
|   `-- Makefile
|-- hello-c_1.0.orig.tar.gz -&gt; hello-c-1.0.tar.gz
`-- hello-c-1.0.tar.gz

4 directories, 14 files</code></pre>
</div></div>
<div class="paragraph"><p>For the proper packaging, you are required to make further modification here.</p></div>
<div class="paragraph"><p>For learning purpose, let&#8217;s leave such details and move on. You can create a non-native Debian package using the <strong>debuild</strong> command (or its equivalents) in this source tree.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-1.0
 $ debuild
 dpkg-buildpackage -rfakeroot -D -us -uc -I -i
 ...
 fakeroot debian/rules clean
dh clean
 ...
 debian/rules build
dh build
 ...
 fakeroot debian/rules binary
dh binary
 ...
Finished running lintian.</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="title">The generated files of version 1.0 by the <strong>debuild</strong> command:</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-c-1.0
|-- hello-c_1.0-1_amd64.build
|-- hello-c_1.0-1_amd64.changes
|-- hello-c_1.0-1_amd64.deb
|-- hello-c_1.0-1.debian.tar.xz
|-- hello-c_1.0-1.dsc
|-- hello-c_1.0.orig.tar.gz -&gt; hello-c-1.0.tar.gz
`-- hello-c-1.0.tar.gz

1 directory, 7 files</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The source package contents of version 1.0:</div>
<div class="content">
<pre><code> $ tar -tJf hello-c_1.0-1.debian.tar.xz
debian/
debian/compat
debian/changelog
debian/watch
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/series
 $ tar -tzf hello-c-1.0.tar.gz
hello-c-1.0/
hello-c-1.0/Makefile
hello-c-1.0/hello.c</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The binary package contents of version 1.0:</div>
<div class="content">
<pre><code> $ dpkg -c hello-c_1.0-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/changelog.Debian.gz</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="modpkg">Modifications</h3>
<div class="paragraph"><p>Let&#8217;s assume we have an older upstream source tarball <strong>hello-c-0.9.tar.gz</strong>.  The <strong>Makefile</strong> of version 0.9 installs its binary to the fixed location <strong>/usr/local/bin/hello</strong> and does not support <strong>$(DESTDIR)</strong> like the one in the upstream source tarball <strong>hello-c-1.0.tar.gz</strong>.</p></div>
<div class="paragraph"><p>There are several methods to prepare the <strong>-p1</strong> patch needed for applying modifications to this <strong>0.9</strong> upstream source.</p></div>
<div class="ulist"><ul>
<li>
<p>
The <strong>diff</strong> command
</p>
</li>
<li>
<p>
The <strong>dquilt</strong> command (alias of the <strong>quilt</strong> command)
</p>
</li>
<li>
<p>
The <strong>git</strong> command with the <strong>--format-patches</strong> option.
</p>
</li>
<li>
<p>
The <strong>git-dpm</strong> command.
</p>
</li>
<li>
<p>
&#8230;
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="dquiltex">Patch file by the <strong>dquilt</strong> command</h4>
<div class="paragraph"><p>Here we show the method with the <strong>dquilt</strong> command.</p></div>
<div class="paragraph"><p>The packaging procedure is the same as that of version 1.0 up to running the <strong>debmake</strong> command.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-0.9
 $ debmake
I: set parameters
I: sanity check of parameters
I: pkg="hello-c", ver="0.9", rev="1"
 ...
 ... (snip)
 ...
I: run "debmake -x2" to get more template files
I: $ wrap-and-sort</code></pre>
</div></div>
<div class="paragraph"><p>The "<strong>dquilt new</strong> &#8230;" command sets the name of the patch.</p></div>
<div class="paragraph"><p>The "<strong>dquilt add</strong> &#8230;" command sets the files to be modified.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dquilt new 0001-destdir.patch
Patch 0001-destdir.patch is now on top
 $ dquilt add Makefile
File Makefile added to patch 0001-destdir.patch
 $ cat Makefile
all: hello

hello: hello.c
        gcc -Wall -o hello hello.c

install: hello
        install -D hello /usr/local/bin/hello

clean:
        -rm -f hello

distclean: clean

.PHONY: all install clean distclean</code></pre>
</div></div>
<div class="paragraph"><p>The <strong>vim</strong> command edits the <strong>Makefile</strong> to be modified to support <strong>$(DESTDIR)</strong>..</p></div>
<div class="paragraph"><p>The "<strong>dquilt refresh</strong> &#8230;" command records the modification as the <strong>-p1</strong> patch in the <strong>debian/patches/</strong> directory.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ vim Makefile
 ...
 $ cat Makefile
all: hello

hello: hello.c
        gcc -Wall -o hello hello.c

install: hello
        install -D hello $(DESTDIR)/usr/bin/hello

clean:
        -rm -f hello

distclean: clean

.PHONY: all install clean distclean
 $ dquilt refresh
Refreshed patch 0001-destdir.patch
 $ cat debian/patches/0001-destdir.patch
--- a/Makefile
+++ b/Makefile
@@ -4,7 +4,7 @@
        gcc -Wall -o hello hello.c

 install: hello
-       install -D hello /usr/local/bin/hello
+       install -D hello $(DESTDIR)/usr/bin/hello

 clean:
        -rm -f hello</code></pre>
</div></div>
<div class="paragraph"><p>The "<strong>dquilt header -e</strong> &#8230;" command adds the <a href="http://dep.debian.net/deps/dep3/">DEP-3: Patch Tagging Guidelines</a> compatible patch header.</p></div>
<div class="paragraph"><p>The "<strong>dquilt pop -a</strong>" command removes all applied patches from the source.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dquilt header -e
 ...
 $ cat debian/patches/0001-destdir.patch
From: Foo Bar &lt;foo@example.org&gt;
Description: make Makefile to support GNU coding standard
 $DESTDIR: debian/hello-c
 $prefix:  /usr/local -&gt; /usr

--- a/Makefile
+++ b/Makefile
@@ -4,7 +4,7 @@
        gcc -Wall -o hello hello.c

 install: hello
-       install -D hello /usr/local/bin/hello
+       install -D hello $(DESTDIR)/usr/bin/hello

 clean:
        -rm -f hello
 $ dquilt pop -a
Removing patch 0001-destdir.patch
Restoring Makefile

No patches applied
 $ cat debian/patches/series
# The patch files of the -p1 format included in the debian/patches direc...
# are applied to the upstream source in the order listed below.
# This is manually managed by users with dquilt (quilt(1) wrapper) etc.
# Also this may be updated by dpkg-source(1) when making a package.
0001-destdir.patch</code></pre>
</div></div>
<div class="paragraph"><p>For the proper packaging, you are required to make further modification here.</p></div>
<div class="paragraph"><p>For learning purpose, let&#8217;s leave such details and move on. You can create a non-native Debian package using the <strong>debuild</strong> command (or its equivalents) in this source tree.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-0.9
 $ debuild
 dpkg-buildpackage -rfakeroot -D -us -uc -I -i
 ...
dpkg-source: info: applying 0001-destdir.patch
 fakeroot debian/rules clean
dh clean
 ...
 debian/rules build
dh build
 ...
 fakeroot debian/rules binary
dh binary
 ...
Finished running lintian.</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect files.</p></div>
<div class="listingblock">
<div class="title">The generated files of version 0.9 by the debuild command:</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-c-0.9
|-- hello-c_0.9-1_amd64.build
|-- hello-c_0.9-1_amd64.changes
|-- hello-c_0.9-1_amd64.deb
|-- hello-c_0.9-1.debian.tar.xz
|-- hello-c_0.9-1.dsc
|-- hello-c_0.9.orig.tar.gz -&gt; hello-c-0.9.tar.gz
`-- hello-c-0.9.tar.gz

1 directory, 7 files</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The source package contents of version 0.9:</div>
<div class="content">
<pre><code> $ dpkg -c hello-c_0.9-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/changelog.Debian.gz</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The binary package contents of version 0.9:</div>
<div class="content">
<pre><code> $ tar -tJf hello-c_0.9-1.debian.tar.xz
debian/
debian/compat
debian/changelog
debian/watch
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/0001-destdir.patch
debian/patches/series
 $ tar -tzf hello-c-0.9.tar.gz
hello-c-0.9/
hello-c-0.9/Makefile
hello-c-0.9/hello.c</code></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="emptypkg">Cherry-pick templates</h3>
<div class="paragraph"><p>Although executing the <strong>debmake</strong> command with the larger <strong>-x</strong><em>[01234]</em> option in the upstream source adds new template files without overwriting the existing ones, it tends to leave too many unused ones and is quite messy.</p></div>
<div class="paragraph"><p>If you wish to get some template files, I recommend to do it as follows with an empty directory, e.g., <em>package/</em>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tree
.
`-- package

1 directory, 0 files</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s get the maximum amount of template files by specifying the <strong>-x4</strong> option.</p></div>
<div class="paragraph"><p>Let&#8217;s also use the "<strong>-t -u</strong> <em>0.0</em>" options to make missing upstream tarball with a version <em>0.0</em>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd package
 $ debmake -t -u 0.0 -x4
 ...
I: debmake -x "4" ...
I: creating =&gt; debian/control
I: creating =&gt; debian/copyright
I: creating =&gt; debian/changelog
 ...
I: creating =&gt; debian/license-examples/Artistic-1.0
I: creating =&gt; debian/license-examples/Apache-2.0
I: creating =&gt; debian/license-examples/LGPL-3.0+
I: $ wrap-and-sort
I: upon return to the shell, current directory becomes /path/to/package
I: please execute "cd /path/to/package-0.0" before building the binary p...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect generated template files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree
.
|-- package
|-- package-0.0
|   `-- debian
|       |-- changelog
|       |-- clean
|       |-- compat
|       |-- control
|       |-- copyright
|       |-- install
|       |-- license-examples
|       |   |-- Apache-2.0
|       |   |-- Artistic-1.0
|       |   |-- BSD-3-Clause
|       |   |-- GPL-2.0+
|       |   |-- GPL-3.0+
|       |   |-- LGPL-2.1+
|       |   |-- LGPL-3.0+
|       |   `-- MIT
|       |-- links
|       |-- manpage.1.ex
|       |-- manpage.asciidoc.ex
|       |-- manpage.sgml.ex
|       |-- manpage.xml.ex
|       |-- menu
|       |-- package.bug-control.ex
|       |-- package.bug-presubj.ex
|       |-- package.bug-script.ex
|       |-- package.conffiles.ex
|       |-- package.cron.daily.ex
|       |-- package.cron.d.ex
|       |-- package.cron.hourly.ex
|       |-- package.cron.monthly.ex
|       |-- package.cron.weekly.ex
|       |-- package.default.ex
|       |-- package.dirs.ex
|       |-- package.emacsen-install.ex
|       |-- package.emacsen-remove.ex
|       |-- package.emacsen-startup.ex
|       |-- package.init.ex
|       |-- package.lintian-overrides.ex
|       |-- package.service.ex
|       |-- package.tmpfile.ex
|       |-- package.upstrat.ex
|       |-- patches
|       |   `-- series
|       |-- postinst
|       |-- postrm
|       |-- preinst
|       |-- prerm
|       |-- README.Debian
|       |-- rules
|       |-- source
|       |   |-- format
|       |   `-- local-options
|       |-- source.lintian-overrides.ex
|       `-- watch
|-- package_0.0.orig.tar.gz -&gt; package-0.0.tar.gz
`-- package-0.0.tar.gz

6 directories, 52 files</code></pre>
</div></div>
<div class="paragraph"><p>Now you can copy any of these generated template files in the <em>package-0.0/</em><strong>debian/</strong> directory to your package as needed.</p></div>
</div>
<div class="sect2">
<h3 id="snappkg">Snapshot (<strong>simple</strong>)</h3>
<div class="paragraph"><p>Let&#8217;s consider an upstream source in the VCS and make a snapshot package from it.</p></div>
<div class="paragraph"><p>Let&#8217;s inspect files.</p></div>
<div class="listingblock">
<div class="title">VCS source tree</div>
<div class="content">
<pre><code> $ tree
.
`-- hello-c
    |-- hello.c
    `-- Makefile

1 directory, 2 files</code></pre>
</div></div>
<div class="paragraph"><p>The source is the same one as <a href="#singlepkg">[singlepkg]</a> but the parent directory lacks the version part since this is the VCS directory.</p></div>
<div class="paragraph"><p>You create a non-native Debian package source tree from the above upstream example using the <strong>debmake</strong>(1) command.</p></div>
<div class="listingblock">
<div class="title"><strong>git</strong> and <strong>debmake</strong></div>
<div class="content">
<pre><code> $ cd hello-c
 $ git init
Initialized empty Git repository in /path/to/hello-c/.git/
 $ git add .
 $ git commit -m "initial commit"
[master (root-commit) d829cfe] initial commit
 2 files changed, 21 insertions(+)
 create mode 100644 Makefile
 create mode 100644 hello.c
 $ git checkout -b devel
Switched to a new branch 'devel'
 $ git branch
* devel
  master
 $ debmake -t
I: set parameters
I: sanity check of parameters
I: pkg="hello-c", ver="0~1403311544", rev="1"
I: make the upstream tarball with "tar --exclude=debian"
I: pwd = "/path/to/hello-c"
I: pwd = "/path/to"
I: $ rsync -aCv --link-dest=/path/to/hello-c hello-c/. hello-c-0~1403311...
sending incremental file list
created directory hello-c-0~1403311544

 ...
I: debmake -x "1" ...
 ...
I: run "debmake -x2" to get more template files
I: $ wrap-and-sort
I: upon return to the shell, current directory becomes /path/to/hello-c
I: please execute "cd /path/to/hello-c-0~1403311544" before building the...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree
.
|-- hello-c
|   |-- hello.c
|   `-- Makefile
|-- hello-c-0~1403311544
|   |-- debian
|   |   |-- changelog
|   |   |-- compat
|   |   |-- control
|   |   |-- copyright
|   |   |-- patches
|   |   |   `-- series
|   |   |-- README.Debian
|   |   |-- rules
|   |   |-- source
|   |   |   |-- format
|   |   |   `-- local-options
|   |   `-- watch
|   |-- hello.c
|   `-- Makefile
|-- hello-c_0~1403311544.orig.tar.gz -&gt; hello-c-0~1403311544.tar.gz
`-- hello-c-0~1403311544.tar.gz

5 directories, 16 files</code></pre>
</div></div>
<div class="paragraph"><p>There are many files:</p></div>
<div class="ulist"><ul>
<li>
<p>
the snapshot upstream tarball: <strong>hello-0~1403311544.tar.gz</strong> (<strong>hello-c_0~1403311544.orig.tar.gz</strong>)
</p>
</li>
<li>
<p>
the snapshot upstream source tree with template files generated by the <strong>debmake</strong> command: <strong>hello-c-0~1403311544/</strong>*
</p>
</li>
<li>
<p>
the cleaned VCS directory: <strong>hello-c-0~1403311544/</strong>*
</p>
</li>
</ul></div>
<div class="paragraph"><p>For the proper packaging, you are required to make further modification using these auto-generated template files in the <strong>hello-c-0~1403311544/debian</strong> directory. For learning purpose, let&#8217;s leave such details and move on. You can create a non-native Debian package using the <strong>debuild</strong> command (or its equivalent) in this source tree.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-0~1403311544
 $ debuild
 dpkg-buildpackage -rfakeroot -D -us -uc -I -i
 ...
 fakeroot debian/rules clean
dh clean
 ...
 debian/rules build
dh build
 ...
 fakeroot debian/rules binary
dh binary
 ...
Finished running lintian.</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-c
|-- hello-c-0~1403311544
|-- hello-c_0~1403311544-1_amd64.build
|-- hello-c_0~1403311544-1_amd64.changes
|-- hello-c_0~1403311544-1_amd64.deb
|-- hello-c_0~1403311544-1.debian.tar.xz
|-- hello-c_0~1403311544-1.dsc
|-- hello-c_0~1403311544.orig.tar.gz -&gt; hello-c-0~1403311544.tar.gz
`-- hello-c-0~1403311544.tar.gz

2 directories, 7 files</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dpkg -c hello-c_0~1403311544-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/changelog.Debian.gz</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -tJf hello-c_0~1403311544-1.debian.tar.xz
debian/
debian/compat
debian/changelog
debian/watch
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/series
 $ tar -tzf hello-c-0~1403311544.tar.gz
hello-c-0~1403311544/
hello-c-0~1403311544/Makefile
hello-c-0~1403311544/hello.c</code></pre>
</div></div>
<div class="paragraph"><p>Your development branch holding the real upstream source tree is the <strong>devel</strong> branch.</p></div>
<div class="paragraph"><p>The following will import generated Debian packages to <strong>master</strong>, <strong>upstream</strong>, and <strong>pristine-tar</strong> branches.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c
 $ git-import-dsc ../hello-c_0~1403311544-1.dsc  \
                  --pristine-tar --create-missing-branches
gbp:info: Tag upstream/0_1403311544 not found, importing Upstream tarbal...
gbp:info: Creating missing branch 'upstream'
pristine-tar: committed hello-c_0~1403311544.orig.tar.gz.delta to branch...
gbp:info: Version '0~1403311544-1' imported under 'hello-c'
 $ git branch
* devel
  master
  pristine-tar
  upstream
 $ gitk --all</code></pre>
</div></div>
<div class="paragraph"><p>The <strong>gitk</strong> command shows the VCS history nicely.</p></div>
</div>
<div class="sect2">
<h3 id="autopkg">Snapshot (<strong>Autotools</strong>)</h3>
<div class="paragraph"><p>Let&#8217;s consider an upstream source in the VCS and make a snapshot package from it.</p></div>
<div class="paragraph"><p>Let&#8217;s make this more fun to use the Autotools (=Autoconf + Automake) its build system where the upstream VCS does not contain auto-generated files while the distributed tarball has many auto-generated files.</p></div>
<div class="paragraph"><p>Let&#8217;s inspect files.</p></div>
<div class="listingblock">
<div class="title">VCS source tree</div>
<div class="content">
<pre><code> $ tree
.
`-- vcsdir
    |-- configure.ac
    |-- hello.c
    `-- Makefile.am

1 directory, 3 files</code></pre>
</div></div>
<div class="paragraph"><p>There are minimalistic configuration files for Autotools.</p></div>
<div class="listingblock">
<div class="title"><strong>configure.ac</strong>:</div>
<div class="content">
<pre><code> $ cat vcsdir/configure.ac
#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.
AC_PREREQ([2.69])
AC_INIT([hello-c], [1.5], [foo@example.org])
AC_CONFIG_SRCDIR([hello.c])
AC_CONFIG_HEADERS([config.h])
# Manually added
AM_INIT_AUTOMAKE([foreign])
# Checks for programs.
AC_PROG_CC
AC_CONFIG_FILES([Makefile])
AC_OUTPUT</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>Makefile.am</strong>:</div>
<div class="content">
<pre><code> $ cat vcsdir/Makefile.am
bin_PROGRAMS = hello
hello_SOURCES = hello.c</code></pre>
</div></div>
<div class="paragraph"><p>The C source <strong>hello.c</strong> is the same one as before.</p></div>
<div class="paragraph"><p>You create a non-native Debian package source tree from the above upstream example using the <strong>debmake</strong>(1) command.</p></div>
<div class="listingblock">
<div class="title"><strong>git</strong> and <strong>debmake</strong></div>
<div class="content">
<pre><code> $ cd vcsdir
 $ git init
Initialized empty Git repository in /path/to/vcsdir/.git/
 $ git add .
 $ git commit -m "initial commit"
[master (root-commit) 7488d5e] initial commit
 3 files changed, 21 insertions(+)
 create mode 100644 Makefile.am
 create mode 100644 configure.ac
 create mode 100644 hello.c
 $ git checkout -b devel
Switched to a new branch 'devel'
 $ git branch
* devel
  master
 $ debmake -d
I: set parameters
I: sanity check of parameters
I: pkg="", ver="", rev="1"
I: make the upstream tarball with "make dist" equivalents
I: pwd = "/path/to/vcsdir"
I: $ autoreconf -ivf &amp;&amp; ./configure --prefix "/usr" &amp;&amp; make distcheck
autoreconf: Entering directory `.'
autoreconf: configure.ac: not using Gettext
autoreconf: running: aclocal --force
 ...
I: debmake -x "1" ...
 ...
I: run "debmake -x2" to get more template files
I: $ wrap-and-sort
I: upon return to the shell, current directory becomes /path/to/vcsdir
I: please execute "cd /path/to/hello-c-1.5" before building the binary p...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s clean <strong>vcsdir/</strong> since it has so many Autotools generated files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ git clean -d -f -x
Removing .deps/
Removing Makefile
Removing Makefile.in
Removing aclocal.m4
Removing autom4te.cache/
Removing compile
Removing config.h
Removing config.h.in
Removing config.log
Removing config.status
Removing configure
Removing depcomp
Removing hello-c-1.5.tar.gz
Removing install-sh
Removing missing
Removing stamp-h1</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree
.
|-- hello-c-1.5
|   |-- aclocal.m4
|   |-- compile
|   |-- config.h.in
|   |-- configure
|   |-- configure.ac
|   |-- debian
|   |   |-- changelog
|   |   |-- compat
|   |   |-- control
|   |   |-- copyright
|   |   |-- patches
|   |   |   `-- series
|   |   |-- README.Debian
|   |   |-- rules
|   |   |-- source
|   |   |   |-- format
|   |   |   `-- local-options
|   |   `-- watch
|   |-- depcomp
|   |-- hello.c
|   |-- install-sh
|   |-- Makefile.am
|   |-- Makefile.in
|   `-- missing
|-- hello-c_1.5.orig.tar.gz -&gt; hello-c-1.5.tar.gz
|-- hello-c-1.5.tar.gz
`-- vcsdir
    |-- configure.ac
    |-- hello.c
    `-- Makefile.am

5 directories, 26 files</code></pre>
</div></div>
<div class="paragraph"><p>There are many files:</p></div>
<div class="ulist"><ul>
<li>
<p>
the snapshot upstream tarball: <strong>hello-1.5.tar.gz</strong> (<strong>hello-c_1.5.orig.tar.gz</strong>)
</p>
</li>
<li>
<p>
the snapshot upstream source tree with template files generated by the <strong>debmake</strong> command: <strong>hello-c-1.5/</strong>*
</p>
</li>
<li>
<p>
the cleaned VCS directory: <strong>vcsdir/</strong>*
</p>
</li>
</ul></div>
<div class="paragraph"><p>For the proper packaging, you are required to make further modification using these auto-generated template files in the <strong>hello-c-1.5/debian</strong> directory. For learning purpose, let&#8217;s leave such details and move on. You can create a non-native Debian package using the <strong>debuild</strong> command (or its equivalent) in this source tree.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-c-1.5
 $ debuild
 dpkg-buildpackage -rfakeroot -D -us -uc -I -i
 ...
 fakeroot debian/rules clean
dh clean --with "autotools-dev"
 ...
 debian/rules build
dh build --with "autotools-dev"
 ...
 fakeroot debian/rules binary
dh binary --with "autotools-dev"
 ...
Finished running lintian.</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-c-1.5
|-- hello-c_1.5-1_amd64.build
|-- hello-c_1.5-1_amd64.changes
|-- hello-c_1.5-1_amd64.deb
|-- hello-c_1.5-1.debian.tar.xz
|-- hello-c_1.5-1.dsc
|-- hello-c_1.5.orig.tar.gz -&gt; hello-c-1.5.tar.gz
|-- hello-c-1.5.tar.gz
`-- vcsdir

2 directories, 7 files</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dpkg -c hello-c_1.5-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/changelog.Debian.gz</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -tJf hello-c_1.5-1.debian.tar.xz
debian/
debian/compat
debian/changelog
debian/watch
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/series
 $ tar -tzf hello-c-1.5.tar.gz
hello-c-1.5/
hello-c-1.5/install-sh
hello-c-1.5/aclocal.m4
hello-c-1.5/Makefile.am
hello-c-1.5/depcomp
hello-c-1.5/configure.ac
hello-c-1.5/config.h.in
hello-c-1.5/compile
hello-c-1.5/Makefile.in
hello-c-1.5/missing
hello-c-1.5/configure
hello-c-1.5/hello.c</code></pre>
</div></div>
<div class="paragraph"><p>Your development branch holding the real upstream source tree is the <strong>devel</strong> branch.</p></div>
<div class="paragraph"><p>The following will import generated Debian packages to <strong>master</strong>, <strong>upstream</strong>, and <strong>pristine-tar</strong> branches.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd vcsdir
 $ git-import-dsc ../hello-c_1.5-1.dsc  \
                  --pristine-tar --create-missing-branches
gbp:info: Tag upstream/1.5 not found, importing Upstream tarball
gbp:info: Creating missing branch 'upstream'
pristine-tar: committed hello-c_1.5.orig.tar.gz.delta to branch pristine...
gbp:info: Version '1.5-1' imported under 'hello-c'
 $ git branch
* devel
  master
  pristine-tar
  upstream
 $ gitk --all</code></pre>
</div></div>
<div class="paragraph"><p>The <strong>gitk</strong> command shows the VCS history nicely.</p></div>
</div>
<div class="sect2">
<h3 id="pythonpkg">Snapshot (<strong>Python</strong>)</h3>
<div class="paragraph"><p>Let&#8217;s consider another upstream source in the VCS and make a snapshot package from it.  Let&#8217;s assume this is a Python3 source package in distutils.</p></div>
<div class="paragraph"><p>Let&#8217;s inspect files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tree
.
`-- vcsdir
    |-- hello-py
    |   `-- __init__.py
    |-- MANIFEST
    |-- MANIFEST.in
    |-- PKG-INFO
    |-- scripts
    |   `-- hello
    `-- setup.py

3 directories, 6 files</code></pre>
</div></div>
<div class="paragraph"><p>There are minimalistic configuration files for Autotools.</p></div>
<div class="listingblock">
<div class="title"><strong>setup.py</strong>:</div>
<div class="content">
<pre><code> $ cat vcsdir/setup.py
#!/usr/bin/python3
# vi:se ts=4 sts=4 et ai:
from distutils.core import setup

setup(name='hello-py',
    version='1.0',
    description='Hello Python',
    long_description='Hello Python program.',
    author='Osamu Aoki',
    author_email='osamu@debian.org',
    url='http://people.debian.org/~osamu/',
    packages=['hello-py'],
    package_dir={'hello-py': 'hello-py'},
    scripts=['scripts/hello'],
    classifiers = ['Development Status :: 3 - Alpha',
        'Environment :: Console',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: MIT License',
        'Natural Language :: English',
        'Operating System :: POSIX :: Linux',
        'Programming Language :: Python :: 3',
        'Topic :: Utilities',
    ],
    platforms   = 'POSIX',
    license     = 'MIT License'
)</code></pre>
</div></div>
<div class="paragraph"><p>The Python program code is as follows.</p></div>
<div class="listingblock">
<div class="title"><strong>scripts/hello</strong> and <strong>hello-py/<em>init</em>.py</strong></div>
<div class="content">
<pre><code> $ cat vcsdir/scripts/hello
#!/usr/bin/python3
# vim:se tw=0 sts=4 ts=4 et si:
"""
Copyright  2014 Osamu Aoki
 ...
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
"""

import hello-py

if __name__ == '__main__':
    hello.main()

 $ cat vcsdir/hello-py/__init__.py
#!/usr/bin/python3
# vim:se tw=0 sts=4 ts=4 et ai:

def main():
    print('Hello Python3!')
    return

if __name__ == '__main__':
    main()</code></pre>
</div></div>
<div class="paragraph"><p>You create a non-native Debian package source tree from the above upstream example using the <strong>debmake</strong>(1) command.  Here package description is copied from the upstream <strong>setup.py</strong> content by the <strong>-s</strong> option.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd vcsdir
 $ git init
Initialized empty Git repository in /path/to/vcsdir/.git/
 $ git add .
 $ git commit -m "initial commit"
[master (root-commit) 432ec13] initial commit
 6 files changed, 93 insertions(+)
 create mode 100644 MANIFEST
 create mode 100644 MANIFEST.in
 create mode 100644 PKG-INFO
 create mode 100755 hello-py/__init__.py
 create mode 100755 scripts/hello
 create mode 100755 setup.py
 $ git branch devel
 $ git branch upstream
 $ git branch
  devel
* master
  upstream
 $ debmake -s -b':python3' -d -i debuild
 ...
I: debmake -x "1" ...
 ...
Finished running lintian.
I: upon return to the shell, current directory becomes /path/to/vcsdir
I: please execute "cd .." and inspect the build results.
 $ git clean -d -f
Removing dist/</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-py-1.0
|-- hello-py_1.0-1_all.deb
|-- hello-py_1.0-1_amd64.build
|-- hello-py_1.0-1_amd64.changes
|-- hello-py_1.0-1.debian.tar.xz
|-- hello-py_1.0-1.dsc
|-- hello-py_1.0.orig.tar.gz -&gt; hello-py-1.0.tar.gz
|-- hello-py-1.0.tar.gz
`-- vcsdir

2 directories, 7 files</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dpkg -c hello-py_1.0-1_all.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/python3/
drwxr-xr-x root/root ...  ./usr/lib/python3/dist-packages/
-rw-r--r-- root/root ...  ./usr/lib/python3/dist-packages/hello_py-1.0.e...
drwxr-xr-x root/root ...  ./usr/lib/python3/dist-packages/hello-py/
-rw-r--r-- root/root ...  ./usr/lib/python3/dist-packages/hello-py/__ini...
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-py/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-py/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-py/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-py/changelog.Debian.gz</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tar -tJf hello-py_1.0-1.debian.tar.xz
debian/
debian/compat
debian/changelog
debian/watch
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/series
 $ tar -tzf hello-py-1.0.tar.gz
hello-py-1.0/
hello-py-1.0/hello-py/
hello-py-1.0/hello-py/__init__.py
hello-py-1.0/scripts/
hello-py-1.0/scripts/hello
hello-py-1.0/MANIFEST.in
hello-py-1.0/PKG-INFO
hello-py-1.0/setup.py
hello-py-1.0/MANIFEST</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s check the generated control file content.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ dpkg -e hello-py_1.0-1_all.deb
 $ tree DEBIAN
DEBIAN
|-- control
|-- md5sums
|-- postinst
`-- prerm

0 directories, 4 files</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s compare how packaging deals with <strong>substvar</strong> etc.</p></div>
<div class="listingblock">
<div class="title"><strong>debian/control</strong> in the source package</div>
<div class="content">
<pre><code> $ cat hello-py-1.0/debian/control
Source: hello-py
Section: unknown
Priority: extra
Maintainer: "Firstname Lastname" &lt;email.address@example.org&gt;
Build-Depends: debhelper (&gt;=9), python3-all
Standards-Version: 3.9.5
Homepage: &lt;insert the upstream URL, if relevant&gt;
X-Python3-Version: &gt;= 3.2

Package: hello-py
Architecture: all
Multi-Arch: foreign
Depends: python3, ${misc:Depends}, ${python3:Depends}
Description: Hello Python
 Hello Python program.</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>DEBIAN/control</strong> in the binary package</div>
<div class="content">
<pre><code> $ cat DEBIAN/control
Package: hello-py
Version: 1.0-1
Architecture: all
Maintainer: "Firstname Lastname" &lt;email.address@example.org&gt;
Installed-Size: 49
Depends: python3, python3:any (&gt;= 3.3.2-2~)
Section: unknown
Priority: extra
Multi-Arch: foreign
Homepage: &lt;insert the upstream URL, if relevant&gt;
Description: Hello Python
 Hello Python program.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="multipkg">Multi binary package</h3>
<div class="paragraph"><p>Let&#8217;s consider an upstream package <strong>hello-1.1.tar.gz</strong> and untar it to inspect files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tree
.
|-- hello-1.1
|   |-- hello.c
|   |-- hello.data
|   |-- hello-sh
|   `-- Makefile
`-- hello-1.1.tar.gz

1 directory, 5 files</code></pre>
</div></div>
<div class="paragraph"><p>This is similar to the previously shown <strong>hello-c-1.0.tar.gz</strong>  but with a few additional files and changes.</p></div>
<div class="paragraph"><p>The C source <strong>hello.c</strong> is the same one.</p></div>
<div class="paragraph"><p><strong>Makefile</strong> is updated to support <strong>$(DESTDIR)</strong> for all files.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cat hello-1.1/Makefile
all: hello

hello: hello.c
        gcc -Wall -o hello hello.c

install: hello hello.data
        install -D hello $(DESTDIR)/usr/bin/hello
        install -D hello-sh $(DESTDIR)/usr/bin/hello-sh
        install -D hello.data $(DESTDIR)/usr/share/hello/hello.data

clean:
        -rm -f hello

distclean: clean

.PHONY: all install clean distclean</code></pre>
</div></div>
<div class="paragraph"><p>There is an additional simple shell script <strong>hello-sh</strong>.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cat hello-1.1/hello-sh
#!/bin/sh
echo "Hello from the shell!"</code></pre>
</div></div>
<div class="paragraph"><p>The <strong>hello.data</strong> file is a dummy data for this training.</p></div>
<div class="paragraph"><p>Let&#8217;s create a set of the following non-native binary Debian packages.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>hello-c</strong> : <em>type</em>=<strong>bin</strong>, This package contains an ELF executable <strong>hello</strong> file compiled the source file <strong>hello.c</strong>.
</p>
</li>
<li>
<p>
<strong>hello-c-dbg</strong> : <em>type</em>=<strong>dbg</strong>, This package contains debug symbols data of the ELF executable file <strong>hello</strong>.
</p>
</li>
<li>
<p>
<strong>hello-sh</strong> : <em>type</em>=<strong>script</strong>, This contains the shell script <strong>hello-sh</strong>.
</p>
</li>
<li>
<p>
<strong>hello-data</strong> : <em>type</em>=<strong>data</strong>, This contains the data file <strong>hello.data</strong>.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Since we are splitting the generated files into multiple packages, we package this in two steps.  The first step is the "<strong>debmake -j</strong> &#8230;" command.</p></div>
<div class="listingblock">
<div class="title">The <strong>debmake</strong> execution (1st stage)</div>
<div class="content">
<pre><code> $ cd hello-1.1
 $ debmake -j -b'-c,-c-dbg,-data:data,-sh:script'
 ...
 ... (snip)
 ...
I: $ LANG=C ; sed -e "1d" &lt; ../hello.depcheck.log | sort &gt;../hello.build...
I: $ LANG=C; find debian/tmp -type f 2&gt;&amp;1 | sed -e "s/^debian\/tmp\///" ...
I: upon return to the shell, current directory becomes /path/to/hello-1....
I: please execute "cd /path/to/hello-1.1" before building the binary pac...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The parent directory after the "<strong>debmake -j</strong> &#8230;" execution.</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-1.1
|-- hello_1.1.orig.tar.gz -&gt; hello-1.1.tar.gz
|-- hello-1.1.tar.gz
|-- hello.build-dep.log
|-- hello.build.log
|-- hello.depcheck.log
`-- hello.install.log

1 directory, 6 files</code></pre>
</div></div>
<div class="paragraph"><p>There are 2 log files in the parent directory.</p></div>
<div class="listingblock">
<div class="title"><strong>hello.build-dep.log</strong> generated by the <strong>dpkg-depcheck</strong> command</div>
<div class="content">
<pre><code> $ cat hello.build-dep.log
 ...
 ... (snip)
 ...</code></pre>
</div></div>
<div class="paragraph"><p>Since the build dependency to the <strong>debhelper</strong> package is always implemented by the <strong>debmake</strong> command and other packages are installed by the dependencies of the <strong>build-essential</strong> package, there is no additional package required be listed as the build dependency.</p></div>
<div class="listingblock">
<div class="title"><strong>hello.install.log</strong> listing files under the <strong>debian/tmp</strong> directory</div>
<div class="content">
<pre><code> $ cat hello.install.log
usr/bin/hello
usr/bin/hello-sh
usr/share/hello/hello.data</code></pre>
</div></div>
<div class="paragraph"><p>Now we know what files are generated in the <strong>debian/tmp</strong> directory.</p></div>
<div class="paragraph"><p>Let&#8217;s start with the fresh source tree and build package from there.</p></div>
<div class="listingblock">
<div class="title">The <strong>debmake</strong> execution (2nd stage)</div>
<div class="content">
<pre><code> $ rm -rf hello-1.1
 $ debmake -b'-c,-c-dbg,-data:data,-sh:script' -a hello-1.1.tar.gz
I: set parameters
I: sanity check of parameters
I: pkg="hello", ver="1.1", rev="1"
 ...
I: parse binary package settings: -c,-c-dbg,-data:data,-sh:script
I: binary package=hello-c Type=bin / Arch=any M-A=foreign
I: binary package=hello-c-dbg Type=dbg / Arch=any M-A=same
I: binary package=hello-data Type=data / Arch=all M-A=foreign
I: binary package=hello-sh Type=script / Arch=all M-A=foreign
 ...
I: debmake -x "2" ...
 ...
I: $ wrap-and-sort
I: upon return to the shell, current directory becomes /path/to
I: please execute "cd /path/to/hello-1.1" before building the binary pac...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="paragraph"><p>Please note that the <strong>debmake</strong> command is run with the <strong>-x2</strong> option as the default for the new multi binary packages.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd hello-1.1
 $ tree
.
|-- debian
|   |-- changelog
|   |-- clean
|   |-- compat
|   |-- control
|   |-- copyright
|   |-- hello-c.doc-base
|   |-- hello-c.docs
|   |-- hello-c.examples
|   |-- hello-c.info
|   |-- hello-c.install
|   |-- hello-c.links
|   |-- hello-c.manpages
|   |-- hello-c.menu
|   |-- hello-c.postinst
|   |-- hello-c.postrm
|   |-- hello-c.preinst
|   |-- hello-c.prerm
|   |-- hello-data.install
|   |-- hello-sh.install
|   |-- patches
|   |   `-- series
|   |-- README.Debian
|   |-- rules
|   |-- source
|   |   |-- format
|   |   `-- local-options
|   `-- watch
|-- hello.c
|-- hello.data
|-- hello-sh
`-- Makefile

3 directories, 29 files</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect generated template files.</p></div>
<div class="listingblock">
<div class="title"><strong>debian/rules</strong>:</div>
<div class="content">
<pre><code> $ cat debian/rules
#!/usr/bin/make -f
# See debhelper(7) (uncomment to enable)
# output every command that modifies files on the build system.
#DH_VERBOSE = 1

# In case you want to add more flags to the defaults, use
# the followings to harden via compiler options
# see FEATURE AREAS in dpkg-buildflags(1))
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all
# see ENVIRONMENT in dpkg-buildflags(1))
# package maintainers to append CFLAGS
#export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
# package maintainers to append LDFLAGS
#export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed



# main packaging script based on dh7 syntax
%:
        dh $@

# debmake generated override targets
# see https://www.debian.org/doc/manuals/developers-reference/best-pkgin...
override_dh_strip:
        dh_strip --dbg-package=hello-c-dbg</code></pre>
</div></div>
<div class="paragraph"><p>This is essentially the standard <strong>debian/rules</strong> file with the <strong>dh</strong> command with <strong>override_dh_strip</strong> to create a debug package. (There are some commented out contents for you to customize it.)</p></div>
<div class="listingblock">
<div class="title"><strong>debian/control</strong>:</div>
<div class="content">
<pre><code> $ cat debian/control
Source: hello
Section: unknown
Priority: extra
Maintainer: "Firstname Lastname" &lt;email.address@example.org&gt;
Build-Depends: debhelper (&gt;=9)
Standards-Version: 3.9.5
Homepage: &lt;insert the upstream URL, if relevant&gt;

Package: hello-c
Architecture: any
Multi-Arch: foreign
Depends: ${misc:Depends}, ${shlibs:Depends}
Description: auto-generated package by debmake: bin
 This package contains the compiled binary executable.
 ...
 ... (snip)
 ...

Package: hello-c-dbg
Section: debug
Architecture: any
Multi-Arch: same
Depends: hello-c (= ${binary:Version}), ${misc:Depends}
Description: auto-generated package by debmake: dbg
 This package contains the debugging symbols.

Package: hello-data
Architecture: all
Multi-Arch: foreign
Depends: ${misc:Depends}
Description: auto-generated package by debmake: data
 This package contains the architecture independent data.

Package: hello-sh
Architecture: all
Multi-Arch: foreign
Depends: ${misc:Depends}
Description: auto-generated package by debmake: script
 This package contains the script program.</code></pre>
</div></div>
<div class="paragraph"><p>Nice to see the templates are generated with reasonable contents.</p></div>
<div class="paragraph"><p>There are several template files under the <strong>debian/</strong> directory.  Let&#8217;s customize them and erase unnecessary ones. (Here, we are skipping details required by the best practice.)</p></div>
<div class="listingblock">
<div class="title">Manual adjustments of <strong>debian/</strong>*</div>
<div class="content">
<pre><code> $ cd ./debian
 $ rm -f *.do* *.examples *.info *.links *.m*  *.p*
 $ rm hello-c-dbg.install
rm: cannot remove hello-c-dbg.install: No such file or directory
 $ echo usr/bin/hello &gt; hello-c.install
 $ echo usr/share/hello/hello.data &gt; hello-data.install
 $ echo usr/bin/hello-sh &gt; hello-sh.install</code></pre>
</div></div>
<div class="paragraph"><p>You can create a non-native Debian package using the <strong>debuild</strong> command (or its equivalents) in this source tree.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ..
 $ debuild
 dpkg-buildpackage -rfakeroot -D -us -uc -I -i
 ...
dpkg-buildpackage: host architecture amd64
 fakeroot debian/rules clean
dh clean
 ...
 debian/rules build
dh build
 ...
 fakeroot debian/rules binary
dh binary
 ...
Finished running lintian.</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="title">The generated files of version 1.0 by the <strong>debuild</strong> command:</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- hello-1.1
|-- hello_1.1-1_amd64.build
|-- hello_1.1-1_amd64.changes
|-- hello_1.1-1.debian.tar.xz
|-- hello_1.1-1.dsc
|-- hello_1.1.orig.tar.gz -&gt; hello-1.1.tar.gz
|-- hello-1.1.tar.gz
|-- hello.build-dep.log
|-- hello.build.log
|-- hello-c_1.1-1_amd64.deb
|-- hello-c-dbg_1.1-1_amd64.deb
|-- hello-data_1.1-1_all.deb
|-- hello.depcheck.log
|-- hello.install.log
`-- hello-sh_1.1-1_all.deb

1 directory, 14 files</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The source package contents of version 1.0:</div>
<div class="content">
<pre><code> $ tar -tJf hello_1.1-1.debian.tar.xz
debian/
debian/compat
debian/clean
debian/changelog
debian/watch
debian/hello-sh.install
debian/hello-c.install
debian/control
debian/copyright
debian/README.Debian
debian/rules
debian/source/
debian/source/format
debian/patches/
debian/patches/series
debian/hello-data.install
 $ tar -tzf hello-1.1.tar.gz
hello-1.1/
hello-1.1/Makefile
hello-1.1/hello.data
hello-1.1/hello-sh
hello-1.1/hello.c</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The binary package contents of version 1.0:</div>
<div class="content">
<pre><code> $ dpkg -c hello-c_1.1-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c/changelog.Debian.gz
 $ dpkg -c hello-c-dbg_1.1-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/debug/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/a9/
-rw-r--r-- root/root ...  ./usr/lib/debug/.build-id/a9/023dfdad9d4c1b846...
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-c-dbg/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c-dbg/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-c-dbg/changelog.Debian.g...
 $ dpkg -c hello-data_1.1-1_all.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-data/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-data/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-data/changelog.Debian.gz...
drwxr-xr-x root/root ...  ./usr/share/hello/
-rwxr-xr-x root/root ...  ./usr/share/hello/hello.data
 $ dpkg -c hello-sh_1.1-1_all.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/hello-sh
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/hello-sh/
-rw-r--r-- root/root ...  ./usr/share/doc/hello-sh/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/hello-sh/changelog.Debian.gz</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">For the multi binary package case, you must provide <em>binarypackage</em><strong>.install</strong> files for all binary packages (excluding <strong>dbg</strong> type ones).  The build result needs to be moved from the <strong>debian/tmp/</strong> directory into the directory for those binary packages.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="librarypkg">Library package</h3>
<div class="paragraph"><p>Let&#8217;s consider an upstream package <strong>libkkc-0.3.2.tar.gz</strong>.</p></div>
<div class="listingblock">
<div class="title">Step 0: Untar &#8230;</div>
<div class="content">
<pre><code> $ tar -xzmf libkkc-0.3.2.tar.gz
 $ cd libkkc-0.3.2
 $ git init
Initialized empty Git repository in /path/to/libkkc-0.3.2/.git/
 $ git add .
 $ git commit -m 'initial import of libkkc-0.3.2.tar.gz'
[master (root-commit) 377b076] initial import of libkkc-0.3.2.tar.gz
 423 files changed, 211360 insertions(+)
 ...
 ... (snip)
 ...
 create mode 100644 tools/kkc.vala
 create mode 100644 tools/kkc_vala.stamp
 $ git branch upstream
 $ git tag upstream/0.3.2
 $ pristine-tar commit ../libkkc-0.3.2.tar.gz
pristine-tar: committed libkkc-0.3.2.tar.gz.delta to branch pristine-tar...</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s make a test build this with the <strong>-j</strong> option.</p></div>
<div class="listingblock">
<div class="title">Step 1: <strong>debmake -j</strong></div>
<div class="content">
<pre><code> $ debmake -j
I: set parameters
I: sanity check of parameters
I: pkg="libkkc", ver="0.3.2", rev="1"
I: *** start packaging in "libkkc-0.3.2". ***
I: provide libkkc_0.3.2.orig.tar.gz for non-native Debian package
I: pwd = "/path/to"
I: $ ln -sf libkkc-0.3.2.tar.gz libkkc_0.3.2.orig.tar.gz
 ...
 ... (snip)
 ...
I: $ wrap-and-sort
I: $ fakeroot dpkg-depcheck -m -C -o ../libkkc.depcheck.log -f -catch-al...
I: $ LANG=C ; sed -e "1d" &lt; ../libkkc.depcheck.log | sort &gt;../libkkc.bui...
I: $ LANG=C; find debian/libkkc -type f 2&gt;&amp;1 | sed -e "s/^debian\/libkkc...
I: upon return to the shell, current directory becomes /path/to/libkkc-0...
I: please execute "cd /path/to/libkkc-0.3.2" before building the binary ...
I: with dpkg-buildpackage (or debuild, pdebuild, sbuild, ...).</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s inspect the package dependency.</p></div>
<div class="listingblock">
<div class="title"><strong>libkkc.build-dep.log</strong></div>
<div class="content">
<pre><code> $ cat ../libkkc.build-dep.log
  autotools-dev
  cpio
  debhelper
  gawk
  gobject-introspection
  gvfs:amd64
  intltool
  libc6-i386
  libc6-x32
  libc6:i386
  libfakechroot:amd64
  libfakeroot:amd64
  libgee-dev
  libgirepository-1.0-1
  libgirepository1.0-dev
  libglib2.0-dev
  libjson-glib-dev
  liblocale-gettext-perl
  libmarisa-dev:amd64
  libpython2.7-stdlib:amd64
  mime-support
  perl-modules
  pkg-config
  python-gobject-2
  python-imaging
  python-input-pad
  python-lazr.uri
  python-marisa
  python-repoze.lru
  python-support
  python-zope.interface
  python2.7-minimal
  valac-0.22
  valac-0.22-vapi</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s inspect the generated files.</p></div>
<div class="listingblock">
<div class="title"><strong>libkkc.install.log</strong></div>
<div class="content">
<pre><code> $ cat ../libkkc.install.log
usr/bin/kkc
usr/bin/kkc-package-data
usr/include/libkkc/libkkc.h
usr/lib/x86_64-linux-gnu/girepository-1.0/Kkc-1.0.typelib
usr/lib/x86_64-linux-gnu/libkkc.la
usr/lib/x86_64-linux-gnu/libkkc.so.2.0.0
usr/lib/x86_64-linux-gnu/pkgconfig/kkc-1.0.pc
usr/share/doc/libkkc/README.Debian
 ...
 ... (snip)
 ...
usr/share/libkkc/templates/libkkc-data/tools/genfilter.py
usr/share/libkkc/templates/libkkc-data/tools/sortlm.py
usr/share/locale/ja/LC_MESSAGES/libkkc.mo
usr/share/vala/vapi/kkc-1.0.deps
usr/share/vala/vapi/kkc-1.0.vapi</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s clean the source tree first.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ git reset --hard HEAD
HEAD is now at 377b076 initial import of libkkc-0.3.2.tar.gz
 $ git clean -xfd
Removing Makefile
Removing config.guess.dh-orig
 ...
 ... (snip)
 ...
Removing tools/kkc
Removing tools/kkc-kkc.o
Removing tools/kkc-package-data</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s create the fresh source tree with the following package split plan.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="33%" />
<col width="33%" />
<col width="33%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>binarypackage</em></p></td>
<td align="left" valign="top"><p class="table"><em>type</em></p></td>
<td align="left" valign="top"><p class="table"><strong>-b</strong> option</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc2</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>lib</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>libkkc2</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc-utils</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>bin</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>-utils</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc2-dbg</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>dbg</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>libkkc2-dbg</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc-utils-dbg</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>dbg</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>-utils-dbg</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc-dev</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>dev</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>-dev</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>libkkc-common</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>data</strong></p></td>
<td align="left" valign="top"><p class="table"><strong>-common:data</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre><code> $ debmake -b'libkkc2,-utils,libkkc2-dbg,-utils-dbg,-dev,-common:data' -...
I: set parameters
I: sanity check of parameters
I: pkg="libkkc", ver="0.3.2", rev="1"
I: *** start packaging in "libkkc-0.3.2". ***
I: provide libkkc_0.3.2.orig.tar.gz for non-native Debian package
I: pwd = "/path/to"
I: $ ln -sf libkkc-0.3.2.tar.gz libkkc_0.3.2.orig.tar.gz
I: pwd = "/path/to/libkkc-0.3.2"
I: parse binary package settings: libkkc2,-utils,libkkc2-dbg,-utils-dbg,...
 ...
 ... (snip)
 ...
I: skipping :: debian/libkkc2.install (file exists)
I: creating =&gt; debian/libkkc2.doc-base
I: creating =&gt; debian/libkkc-utils.install
I: creating =&gt; debian/libkkc-dev.install
I: creating =&gt; debian/libkkc-common.install
I: run "debmake -x3" to get more template files
I: $ wrap-and-sort</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s commit this result.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ git add -A .
 $ git commit -m debmake_template
[master e558727] debmake_template
 27 files changed, 1859 insertions(+)
 create mode 100644 debian/README.Debian
 ...
 ... (snip)
 ...</code></pre>
</div></div>
<div class="paragraph"><p>This generats the following source tree. (Too large to list here.)</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ tree
.
|-- aclocal.m4
|-- AUTHORS
|-- autogen.sh
|-- ChangeLog
|-- compile
|-- config.guess
|-- config.h.in
|-- config.sub
|-- configure
|-- configure.ac
|-- COPYING
|-- data
|   |-- Makefile.am
 ...
 ... (snip)
 ...
|   |-- user-segment-dictionary-bad2
|   |-- user-segment-dictionary-good
|   |-- user-sentence-dictionary-bad1
|   |-- user-sentence-dictionary-bad2
|   `-- user-sentence-dictionary-good
`-- tools
    |-- kkc.c
    |-- kkc-package-data.in
    |-- kkc.vala
    |-- kkc_vala.stamp
    |-- Makefile.am
    `-- Makefile.in

95 directories, 438 files
 $ cd debian</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s make manual modifications to the files under the <strong>debian</strong> directory.</p></div>
<div class="listingblock">
<div class="title"><strong>changelog</strong></div>
<div class="content">
<pre><code> $ vim changelog
 ...
 $ cat changelog
libkkc (0.3.2-1) unstable; urgency=low

  * First upload to debian archive (Closes: #715232)
  * Depends skkdic
  * Update debian/license

 -- Mitsuya Shibata &lt;mty.shibata@gmail.com&gt;  Wed, 26 Feb 2014 22:51:39 +...</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>compat</strong></div>
<div class="content">
<pre><code> $ cat compat
9</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>control</strong></div>
<div class="content">
<pre><code> $ vim control
 ...
 $ cat control
Source: libkkc
Priority: extra
Maintainer: IME Packaging Team &lt;pkg-ime-devel@lists.alioth.debian.org&gt;
Uploaders: Mitsuya Shibata &lt;mty.shibata@gmail.com&gt;,
           Osamu Aoki &lt;osamu@debian.org&gt;
Build-Depends: autotools-dev,
               debhelper (&gt;= 9),
               gobject-introspection,
               intltool,
               libgee-dev,
               libgirepository1.0-dev,
               libglib2.0-dev,
               libjson-glib-dev,
               libmarisa-dev,
               python-marisa,
               valac
Standards-Version: 3.9.5
Section: libs
Homepage: https://bitbucket.org/libkkc/libkkc/wiki/Home
Vcs-Git: git://anonscm.debian.org/pkg-ime/libkkc.git
Vcs-Browser: http://anonscm.debian.org/gitweb/?p=pkg-ime/libkkc.git

Package: libkkc2
Architecture: any
Multi-Arch: same
Pre-Depends: ${misc:Pre-Depends}
Depends: libkkc-common, libkkc-data, skkdic, ${misc:Depends}, ${shlibs:D...
Description: Japanese Kana Kanji input library
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package provides the shared library for libkkc.

Package: libkkc-utils
Section: utils
Architecture: any
Multi-Arch: foreign
Depends: libkkc-data,
         libkkc2 (= ${binary:Version}),
         ${misc:Depends},
         ${shlibs:Depends}
Description: Japanese Kana Kanji input library - testing utility
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package provides the testing utility for libkkc.

Package: libkkc2-dbg
Section: debug
Architecture: any
Multi-Arch: same
Depends: libkkc2 (= ${binary:Version}), ${misc:Depends}
Description: Japanese Kana Kanji input library - library debugging symbo...
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package contains the debugging symbols for the shared library of l...

Package: libkkc-utils-dbg
Section: debug
Architecture: any
Multi-Arch: same
Depends: libkkc-utils (= ${binary:Version}), ${misc:Depends}
Description: Japanese Kana Kanji input library - utility debugging symbo...
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package contains the debugging symbols for the testing utility of ...

Package: libkkc-dev
Section: libdevel
Architecture: any
Multi-Arch: same
Depends: libkkc2 (= ${binary:Version}), ${misc:Depends}
Description: Japanese Kana Kanji input library - development files
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package provides the files necessary for compiling programs that
 depend on libkkc.

Package: libkkc-common
Section: utils
Architecture: all
Multi-Arch: foreign
Depends: ${misc:Depends}
Description: Japanese Kana Kanji input library - common data
 libkkc provides a converter from Japanese Kana-string to
 Kana-Kanji-mixed-string. It was named after kkc.el in GNU Emacs, a simp...
 Kanji converter, while libkkc tries to convert sentences in a bit more ...
 way using N-gram language models.
 .
 This package provides common data such as typing rules for libkkc.</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>copyright</strong></div>
<div class="content">
<pre><code> $ vim copyright
 ...
 $ cat copyright
Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0...
Upstream-Name: libkkc
Source: https://bitbucket.org/libkkc/libkkc/wiki/Home

Files: *
Copyright: 2011-2013 Daiki Ueno &lt;ueno@gnu.org&gt;
           2011-2013 Red Hat, Inc.
License: GPL-3.0+
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 .
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.

Files: debian/*
 ...
 ... (snip)
 ...

Files: INSTALL
Copyright: 1994-2011 Free Software Foundation, Inc.
License: PERMISSIVE
 Copying and distribution of this file, with or without modification,
 are permitted in any medium without royalty provided the copyright
 notice and this notice are preserved.  This file is offered as-is,
 without warranty of any kind.</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>kkc.1</strong></div>
<div class="content">
<pre><code> $ vim kkc.1
 ...
 $ cat kkc.1
.\"                                      Hey, EMACS: -*- nroff -*-
.\" (C) Copyright 2013 Mitsuya Shibata &lt;mty.shibata@gmail.com&gt;,
.\"
.\" First parameter, NAME, should be all caps
.\" Second parameter, SECTION, should be 1-8, maybe w/ subsection
.\" other parameters are allowed: see man(7), man(1)
.TH KKC 1 "DEC 2013"
.\" Please adjust this date whenever revising the manpage.
.\"
.\" Some roff macros, for reference:
.\" .nh        disable hyphenation
.\" .hy        enable hyphenation
.\" .ad l      left justify
.\" .ad b      justify to both left and right margins
.\" .nf        disable filling
.\" .fi        enable filling
.\" .br        insert line break
.\" .sp &lt;n&gt;    insert n+1 empty lines
.\" for manpage-specific macros, see man(7)
.SH NAME
kkc \- a simple Kana Kanji converter
.SH SYNOPSIS
.B kkc
.I \fR[\fI help \fR|\fI decoder \fR|\fI context \fR]\fI
.RI [ OPTIONS ]
.SH DESCRIPTION
kkc converte from Kana-string to Kana-Kanji-mixed-string and list up
candidates.
.PP
Users can specify parameters through command line options. See
\fBkkc help\fP or \fBkkc command \-\-help\fP for the list of options.
.SH SEE ALSO
See /usr/share/doc/libkkc-utils/README for usage example.</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>install</strong> files</div>
<div class="content">
<pre><code> $ echo 'usr/share/libkkc/rules/*' &gt; libkkc-common.install
 $ echo 'usr/include/*'            &gt; libkkc-dev.install
 $ echo 'usr/lib/*/lib*.so'        &gt;&gt;libkkc-dev.install
 $ echo 'usr/lib/*/pkgconfig/*'    &gt;&gt;libkkc-dev.install
 $ echo 'usr/share/vala/vapi/*'    &gt;&gt;libkkc-dev.install
 $ echo 'usr/bin/kkc'              &gt; libkkc-utils.install
 $ echo 'usr/share/locale/'        &gt;&gt;libkkc-utils.install
 $ echo 'usr/lib/*/lib*.so.*'      &gt;&gt;libkkc2.install
 $ echo 'README'                   &gt; libkkc-utils.docs
 $ echo 'debian/kkc.1'             &gt; libkkc-utils.manpages</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><strong>rules</strong></div>
<div class="content">
<pre><code> $ vim rules
 ...
 $ cat rules
#!/usr/bin/make -f
#DH_VERBOSE = 1

# In case you want to add more flags to the defaults, use
# the followings to harden via compiler options
# see FEATURE AREAS in dpkg-buildflags(1))
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all
# see ENVIRONMENT in dpkg-buildflags(1))
# package maintainers to append CFLAGS
export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
# package maintainers to append LDFLAGS
export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed

VALAFLAGS:=$(foreach w,$(CPPFLAGS) $(CFLAGS) $(LDFLAGS),-X $(w))

%:
        dh $@ --with autotools-dev,gir

override_dh_auto_configure:
        dh_auto_configure -- --disable-silent-rules

override_dh_strip:
        dh_strip -Xlibkkc-utils --dbg-package=libkkc2-dbg
        dh_strip -Xlibkkc2 --dbg-package=libkkc-utils-dbg</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Remove unused template files</div>
<div class="content">
<pre><code> $ rm -f clean
 $ rm -f libkkc2.examples
 $ rm -f libkkc2.info
 $ rm -f libkkc2.postinst
 $ rm -f libkkc2.postrm
 $ rm -f libkkc2.preinst
 $ rm -f libkkc2.prerm</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s record packaging result into VCS.</p></div>
<div class="paragraph"><p>(Hmmmm&#8230;. importing upstream with pristine-tar first is better but let&#8217;s not worry now.)</p></div>
<div class="listingblock">
<div class="content">
<pre><code> $ cd ../
 $ git add -A .
 $ git commit -m initial_commit
[master c97da03] initial_commit
 18 files changed, 518 insertions(+), 1763 deletions(-)
 delete mode 100644 debian/clean
 rewrite debian/control (74%)
 rewrite debian/copyright (79%)
 create mode 100644 debian/kkc.1
 create mode 100644 debian/libkkc-utils.docs
 create mode 100644 debian/libkkc-utils.manpages
 delete mode 100644 debian/libkkc2.examples
 delete mode 100644 debian/libkkc2.info
 delete mode 100644 debian/libkkc2.postinst
 delete mode 100644 debian/libkkc2.postrm
 ...
 ... (snip)
 ...
 delete mode 100644 debian/libkkc2.info
 delete mode 100644 debian/libkkc2.postinst
 delete mode 100644 debian/libkkc2.postrm
 delete mode 100644 debian/libkkc2.preinst
 delete mode 100644 debian/libkkc2.prerm</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s build this package under the <strong>pdebuild</strong> command.</p></div>
<div class="listingblock">
<div class="title">The first <strong>pdebuild</strong></div>
<div class="content">
<pre><code> $ pdebuild
dpkg-buildpackage: source package libkkc
dpkg-buildpackage: source version 0.3.2-1
 ...
 dpkg-source --before-build libkkc-0.3.2
 fakeroot debian/rules clean
make[1]: Entering directory `/path/to/libkkc-0.3.2'
--
dpkg-buildpackage: host architecture amd64
 fakeroot debian/rules clean
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
 debian/rules build
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
 fakeroot debian/rules binary
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
dpkg-gensymbols: warning: new libraries appeared in the symbols file: li...
dpkg-gensymbols: warning: debian/libkkc2/DEBIAN/symbols doesn't match co...
--- debian/libkkc2.symbols (libkkc2_0.3.2-1_amd64)
+++ dpkg-gensymbolsw3FSQO       2014-04-02 15:43:15.582561319 +0000
@@ -0,0 +1,344 @@
+libkkc.so.2 libkkc2 #MINVER#
+ kkc_bigram_decoder_add_unknown_nodes@Base 0.3.2-1
+ kkc_bigram_decoder_backward_search@Base 0.3.2-1
+ kkc_bigram_decoder_build_trellis@Base 0.3.2-1
+ kkc_bigram_decoder_construct@Base 0.3.2-1
+ kkc_bigram_decoder_forward_search@Base 0.3.2-1
+ kkc_bigram_decoder_get_model@Base 0.3.2-1
 ...
  forking: rm -rf /var/cache/pbuilder/build//cow.10460</code></pre>
</div></div>
<div class="listingblock">
<div class="title">Restore source tree using VCS</div>
<div class="content">
<pre><code> $ git reset --hard HEAD
HEAD is now at c97da03 initial_commit
 $ git clean -d -f -x
 ...
 ... (snip)
 ...</code></pre>
</div></div>
<div class="paragraph"><p>Using <strong>mc</strong>, copy <strong>DEBIAN/symbols</strong> from the <strong>libkkc2_0.3.2-1_amd64.deb</strong> package to <strong>debian/libkkc2.symbols</strong>. (Of course, you can manually use the <strong>dpkg-deb</strong> command.)</p></div>
<div class="listingblock">
<div class="title">Update <strong>debian/libkkc2.symbols</strong></div>
<div class="content">
<pre><code> $ vim debian/libkkc2.symbols
 ... (:%s/-1$//)
 ... (:wq)
 $ cat debian/libkkc2.symbols
libkkc.so.2 libkkc2 #MINVER#
 kkc_bigram_decoder_add_unknown_nodes@Base 0.3.2
 kkc_bigram_decoder_backward_search@Base 0.3.2
 kkc_bigram_decoder_build_trellis@Base 0.3.2
 kkc_bigram_decoder_construct@Base 0.3.2
 kkc_bigram_decoder_forward_search@Base 0.3.2
 ...
 ... (snip)
 ...</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The second <strong>pdebuild</strong></div>
<div class="content">
<pre><code> $ pdebuild
dpkg-buildpackage: source package libkkc
dpkg-buildpackage: source version 0.3.2-1
 ...
 dpkg-source --before-build libkkc-0.3.2
 fakeroot debian/rules clean
make[1]: Entering directory `/path/to/libkkc-0.3.2'
--
dpkg-buildpackage: host architecture amd64
 fakeroot debian/rules clean
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
 debian/rules build
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
 fakeroot debian/rules binary
make[1]: Entering directory `/tmp/buildd/libkkc-0.3.2'
 ...
  forking: rm -rf /var/cache/pbuilder/build//cow.4080</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The build result</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- libkkc-0.3.2
|-- libkkc_0.3.2-1_amd64.build
|-- libkkc_0.3.2-1_amd64.changes
|-- libkkc_0.3.2-1.debian.tar.xz
|-- libkkc_0.3.2-1.dsc
|-- libkkc_0.3.2-1_source.changes
|-- libkkc_0.3.2.orig.tar.gz -&gt; libkkc-0.3.2.tar.gz
|-- libkkc-0.3.2.tar.gz
|-- libkkc2_0.3.2-1_amd64.deb
|-- libkkc2-dbg_0.3.2-1_amd64.deb
|-- libkkc.build-dep.log
|-- libkkc.build.log
|-- libkkc-common_0.3.2-1_all.deb
|-- libkkc.depcheck.log
|-- libkkc-dev_0.3.2-1_amd64.deb
|-- libkkc.install.log
|-- libkkc-utils_0.3.2-1_amd64.deb
`-- libkkc-utils-dbg_0.3.2-1_amd64.deb

1 directory, 17 files</code></pre>
</div></div>
<div class="paragraph"><p>Lets inspect the result.</p></div>
<div class="listingblock">
<div class="title">The generated files of version 1.0 by the <strong>debuild</strong> command:</div>
<div class="content">
<pre><code> $ cd ..
 $ tree -L 1
.
|-- libkkc-0.3.2
|-- libkkc_0.3.2-1_amd64.build
|-- libkkc_0.3.2-1_amd64.changes
|-- libkkc_0.3.2-1.debian.tar.xz
|-- libkkc_0.3.2-1.dsc
|-- libkkc_0.3.2-1_source.changes
|-- libkkc_0.3.2.orig.tar.gz -&gt; libkkc-0.3.2.tar.gz
|-- libkkc-0.3.2.tar.gz
|-- libkkc2_0.3.2-1_amd64.deb
|-- libkkc2-dbg_0.3.2-1_amd64.deb
|-- libkkc.build-dep.log
|-- libkkc.build.log
|-- libkkc-common_0.3.2-1_all.deb
|-- libkkc.depcheck.log
|-- libkkc-dev_0.3.2-1_amd64.deb
|-- libkkc.install.log
|-- libkkc-utils_0.3.2-1_amd64.deb
`-- libkkc-utils-dbg_0.3.2-1_amd64.deb

1 directory, 17 files</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The source package contents:</div>
<div class="content">
<pre><code> $ tar -tJf libkkc_0.3.2-1.debian.tar.xz
debian/
debian/libkkc-utils.docs
debian/libkkc2.menu
debian/libkkc2.manpages
debian/compat
debian/libkkc2.links
debian/changelog
debian/watch
debian/libkkc2.install
debian/kkc.1
 ...
 $ tar -tzf libkkc-0.3.2.tar.gz
libkkc-0.3.2/
libkkc-0.3.2/missing
libkkc-0.3.2/tools/
libkkc-0.3.2/tools/kkc_vala.stamp
libkkc-0.3.2/tools/kkc.vala
libkkc-0.3.2/tools/Makefile.in
libkkc-0.3.2/tools/kkc-package-data.in
libkkc-0.3.2/tools/Makefile.am
libkkc-0.3.2/tools/kkc.c
libkkc-0.3.2/NEWS
 ...</code></pre>
</div></div>
<div class="listingblock">
<div class="title">The binary package contents:</div>
<div class="content">
<pre><code> $ dpkg -c libkkc2_0.3.2-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/x86_64-linux-gnu/
-rw-r--r-- root/root ...  ./usr/lib/x86_64-linux-gnu/libkkc.so.2.0.0
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc2/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2/README.Debian
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2/changelog.Debian.gz
drwxr-xr-x root/root ...  ./usr/share/menu/
-rw-r--r-- root/root ...  ./usr/share/menu/libkkc2
lrwxrwxrwx root/root ...  ./usr/lib/x86_64-linux-gnu/libkkc.so.2 -&gt; libk...
 $ dpkg -c libkkc2-dbg_0.3.2-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/debug/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/6a/
-rw-r--r-- root/root ...  ./usr/lib/debug/.build-id/6a/87fbe93c7f4705859...
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc2-dbg/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2-dbg/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2-dbg/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc2-dbg/changelog.Debian.g...
 $ dpkg -c libkkc-common_0.3.2-1_all.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc-common/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-common/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-common/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-common/changelog.Debian...
drwxr-xr-x root/root ...  ./usr/share/libkkc/
 ...
 ... (snip)
 ...
-rw-r--r-- root/root ...  ./usr/share/libkkc/rules/default/keymap/hankak...
-rw-r--r-- root/root ...  ./usr/share/libkkc/rules/default/keymap/wide-l...
-rw-r--r-- root/root ...  ./usr/share/libkkc/rules/default/keymap/direct...
-rw-r--r-- root/root ...  ./usr/share/libkkc/rules/default/metadata.json...
drwxr-xr-x root/root ...  ./usr/share/libkkc/rules/default/rom-kana/
-rw-r--r-- root/root ...  ./usr/share/libkkc/rules/default/rom-kana/defa...
 $ dpkg -c libkkc-dev_0.3.2-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/include/
drwxr-xr-x root/root ...  ./usr/include/libkkc/
-rw-r--r-- root/root ...  ./usr/include/libkkc/libkkc.h
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/x86_64-linux-gnu/
drwxr-xr-x root/root ...  ./usr/lib/x86_64-linux-gnu/pkgconfig/
-rw-r--r-- root/root ...  ./usr/lib/x86_64-linux-gnu/pkgconfig/kkc-1.0.p...
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc-dev/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-dev/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-dev/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-dev/changelog.Debian.gz...
drwxr-xr-x root/root ...  ./usr/share/vala/
drwxr-xr-x root/root ...  ./usr/share/vala/vapi/
-rw-r--r-- root/root ...  ./usr/share/vala/vapi/kkc-1.0.vapi
-rw-r--r-- root/root ...  ./usr/share/vala/vapi/kkc-1.0.deps
lrwxrwxrwx root/root ...  ./usr/lib/x86_64-linux-gnu/libkkc.so -&gt; libkkc...
 $ dpkg -c libkkc-utils_0.3.2-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/bin/
-rwxr-xr-x root/root ...  ./usr/bin/kkc
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/locale/
drwxr-xr-x root/root ...  ./usr/share/locale/ja/
drwxr-xr-x root/root ...  ./usr/share/locale/ja/LC_MESSAGES/
-rw-r--r-- root/root ...  ./usr/share/locale/ja/LC_MESSAGES/libkkc.mo
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc-utils/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils/changelog.Debian....
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils/README
drwxr-xr-x root/root ...  ./usr/share/man/
drwxr-xr-x root/root ...  ./usr/share/man/man1/
-rw-r--r-- root/root ...  ./usr/share/man/man1/kkc.1.gz
 $ dpkg -c libkkc-utils-dbg_0.3.2-1_amd64.deb
drwxr-xr-x root/root ...  ./
drwxr-xr-x root/root ...  ./usr/
drwxr-xr-x root/root ...  ./usr/lib/
drwxr-xr-x root/root ...  ./usr/lib/debug/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/
drwxr-xr-x root/root ...  ./usr/lib/debug/.build-id/20/
-rw-r--r-- root/root ...  ./usr/lib/debug/.build-id/20/afe1a56a5caa24363...
drwxr-xr-x root/root ...  ./usr/share/
drwxr-xr-x root/root ...  ./usr/share/doc/
drwxr-xr-x root/root ...  ./usr/share/doc/libkkc-utils-dbg/
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils-dbg/changelog.gz
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils-dbg/copyright
-rw-r--r-- root/root ...  ./usr/share/doc/libkkc-utils-dbg/changelog.Deb...</code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix">Appendix</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="manpage"><strong>debmake</strong>(1)</h3>
<div class="sect3">
<h4 id="_name">NAME</h4>
<div class="paragraph"><p>debmake - program to make the Debian source package</p></div>
</div>
<div class="sect3">
<h4 id="_synopsis">SYNOPSIS</h4>
<div class="paragraph"><p><strong>debmake</strong>  [<strong>-h</strong>]  [<strong>-c</strong>] [<strong>-n</strong> | <strong>-a</strong> <em>package-version</em><strong>.orig.tar.gz</strong> | <strong>-d</strong> | <strong>-t</strong> ] [<strong>-p</strong> <em>package</em>] [<strong>-u</strong> <em>version</em>] [<strong>-r</strong> <em>revision</em>] [<strong>-z</strong> <em>extension</em>] [<strong>-b</strong> "<em>binarypackage</em><em><span class=":__type__">, &#8230;</span></em>]" [<strong>-e</strong> <em>foo@example.org</em>] [<strong>-f</strong> "<em>firstname lastname</em>"] [<strong>-i</strong> "<em>buildtool</em>" | <strong>-j</strong>] [<strong>-l</strong> <em>license_file</em>] [<strong>-m</strong>] [<strong>-o</strong> <em>file</em>] [<strong>-q</strong>] [<strong>-s</strong>] [<strong>-v</strong>] [<strong>-w</strong> "<em>addon, &#8230;</em>"] [<strong>-x</strong> [01234]] [<strong>-y</strong>]</p></div>
</div>
<div class="sect3">
<h4 id="_description">DESCRIPTION</h4>
<div class="paragraph"><p><strong>debmake</strong> helps to build the Debian package from the upstream source.  Normally, this is done as follows:</p></div>
<div class="ulist"><ul>
<li>
<p>
The upstream tarball is downloaded as the <em>package-version</em><strong>.tar.gz</strong> file.
</p>
</li>
<li>
<p>
It is untared to create many files under the <em>package-version/</em> directory.
</p>
</li>
<li>
<p>
debmake is invoked in the <em>package-version/</em> directory possibly without any arguments.
</p>
</li>
<li>
<p>
Files in the <em>package-version</em><strong>/debian/</strong> directory are manually adjusted.
</p>
</li>
<li>
<p>
<strong>dpkg-buildpackage</strong> (usually from its wrapper <strong>debuild</strong> or <strong>pdebuild</strong>) is invoked in the <em>package-version/</em> directory to make debian packages.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Make sure to protect the arguments of the <strong>-b</strong>, <strong>-f</strong>, <strong>-l</strong>, and <strong>-w</strong> options from the shell interference by quoting them properly.</p></div>
<div class="sect4">
<h5 id="_optional_arguments">optional arguments:</h5>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>-h</strong>, <strong>--help</strong>
</dt>
<dd>
<p>
show this help message and exit.
</p>
</dd>
<dt class="hdlist1">
<strong>-c</strong>, <strong>--copyright</strong>
</dt>
<dd>
<p>
scan source for copyright+license text and exit.
</p>
<div class="ulist"><ul>
<li>
<p>
<strong>-c</strong>: sinple output style
</p>
</li>
<li>
<p>
<strong>-cc</strong>: normal output style (similar to the <strong>debian/copyright</strong> file)
</p>
</li>
<li>
<p>
<strong>-ccc</strong>: debug output style
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<strong>-n</strong>, <strong>--native</strong>
</dt>
<dd>
<p>
make a native Debian source package without <strong>.orig.tar.gz</strong>.  This makes the "<strong>3.0 (native)</strong>" format package.
</p>
<div class="paragraph"><p>If you are thinking to package a Debian specific source tree with <strong>debian/</strong>* in it into a native Debian package, please think otherwise.  You can use  "<strong>debmake -d  -i debuild</strong>" or "<strong>debmake -t -i debuild</strong>" to make the "<strong>3.0 (quilt)</strong>" format non-native Debian package.  The only difference is that the <strong>debian/changelog</strong> file must use the  non-native version scheme: <em>version-revision</em>.  The non-native package is more friendly to the downstream distributions.</p></div>
</dd>
<dt class="hdlist1">
<strong>-a</strong> <em>package-version</em><strong>.tar.gz</strong>, <strong>--archive</strong> <em>package-version</em><strong>.tar.gz</strong>
</dt>
<dd>
<p>
use the upstream source tarball directly. (<strong>-p</strong>, <strong>-u</strong>, <strong>-z</strong>: overridden)
</p>
<div class="paragraph"><p>The upstream tarball may be specified as <em>package_version</em><strong>.orig.tar.gz</strong> and <strong>tar.gz</strong> for all cases may be <strong>tar.bz2</strong>, or <strong>tar.xz</strong>.</p></div>
<div class="paragraph"><p>If the specified upstream tarball name contains uppercase letters, the Debian package name is generated by converting them to lowercase letters.</p></div>
<div class="paragraph"><p>If the specified argument is the URL (http://, https://, or ftp://) to the upstream tarball, the upstream tarball is downloaded from the URL using <strong>wget</strong> or <strong>curl</strong>.</p></div>
</dd>
<dt class="hdlist1">
<strong>-d</strong>, <strong>--dist</strong>
</dt>
<dd>
<p>
run "make dist" equivalent first to generate upstream tarball and use it.
</p>
<div class="paragraph"><p>"<strong>debmake -d</strong>" is designed to run in the <em>package/</em> directory hosting the upstream VCS with the build system supporting "<strong>make dist</strong>" equivalents.  (automake/autoconf, Python distutils, &#8230;)</p></div>
</dd>
<dt class="hdlist1">
<strong>-t</strong>, <strong>--tar</strong>
</dt>
<dd>
<p>
run "<strong>tar</strong>" to generate upstream tarball and use it
</p>
<div class="paragraph"><p>"<strong>debmake -t</strong>" is designed to run in the <em>package/</em> directory hosting the upstream VCS.  Unless you provide the upstream version with the <strong>-u</strong> option or with the <strong>debian/changelog</strong> file, a snapshot upstream version is generated in the 0~%y%m%d%H%M format, e.g., 0~1403012359, from the UTC date and time.  The generated tarball excludes the <strong>debian/</strong> directory found in the upstream VCS. (It also excludes typical VCS directories: <strong>.git/ .hg/ .svn/ .CVS/</strong>)</p></div>
</dd>
<dt class="hdlist1">
<strong>-p</strong> <em>package</em>, <strong>--package</strong> <em>package</em>
</dt>
<dd>
<p>
set the Debian package name.
</p>
</dd>
<dt class="hdlist1">
<strong>-u</strong> <em>version</em>, <strong>--upstreamversion</strong> <em>version</em>
</dt>
<dd>
<p>
set the upstream package version.
</p>
</dd>
<dt class="hdlist1">
<strong>-r</strong> <em>revision</em>, <strong>--revision</strong> <em>revision</em>
</dt>
<dd>
<p>
set the Debian package revision.
</p>
</dd>
<dt class="hdlist1">
<strong>-z</strong> <em>extension</em>, <strong>--targz</strong> <em>extension</em>
</dt>
<dd>
<p>
set the tarball type, <em>extension</em>=(<strong>tar.gz</strong>|<strong>tar.bz2</strong>|<strong>tar.xz</strong>) (alias: <strong>z</strong>, <strong>b</strong>, <strong>x</strong>)
</p>
</dd>
<dt class="hdlist1">
<strong>-b</strong> "<em>binarypackage[:type],&#8230;</em>", <strong>--binaryspec</strong> "<em>binarypackage[:type],&#8230;</em>"
</dt>
<dd>
<p>
set binary package specs by the comma separated list of <em>binarypackage:type</em> pairs, e.g., in full form "<strong>foo:bin,foo-doc:doc,libfoo1:lib,libfoo1-dbg:dbg,libfoo-dev:dev</strong>" or in short form "<strong>,-doc,libfoo1,libfoo1-dbg, libfoo-dev</strong>".
</p>
<div class="paragraph"><p>Here, <em>binarypackage</em> is the binary package name; and optional <em>type</em> is chosen from the following <em>type</em> values:</p></div>
<div class="openblock">
<div class="content">
<div class="ulist"><ul>
<li>
<p>
<strong>bin</strong>: C/C++ compiled ELF binary code package (any, foreign) (default, alias: <strong>""</strong>, i.e., <em>null-string</em>)
</p>
</li>
<li>
<p>
<strong>data</strong>: Data (fonts, graphics, &#8230;) package (all, foreign) (alias: <strong>da</strong>)
</p>
</li>
<li>
<p>
<strong>dbg</strong>: Debug symbol package (any, same) (alias: <strong>db</strong>)
</p>
</li>
<li>
<p>
<strong>dev</strong>: Library development package (any, same) (alias: <strong>de</strong>)
</p>
</li>
<li>
<p>
<strong>doc</strong>: Documentation package (all, foreign) (alias: <strong>do</strong>)
</p>
</li>
<li>
<p>
<strong>lib</strong>: Library package (any, same) (alias: <strong>l</strong>)
</p>
</li>
<li>
<p>
<strong>perl</strong>: Perl script package (all, foreign) (alias: <strong>pl</strong>)
</p>
</li>
<li>
<p>
<strong>python</strong>: Python script package (all, foreign) (alias: <strong>py</strong>)
</p>
</li>
<li>
<p>
<strong>python3</strong>: Python3 script package (all, foreign) (alias: <strong>py3</strong>)
</p>
</li>
<li>
<p>
<strong>ruby</strong>: Ruby script package (all, foreign) (alias: <strong>rb</strong>)
</p>
</li>
<li>
<p>
<strong>script</strong>: Shell script package (all, foreign) (alias: <strong>sh</strong>)
</p>
</li>
</ul></div>
</div></div>
<div class="paragraph"><p>The pair values in the parentheses, such as (any, foreign), are the <strong>Architecture</strong> and <strong>Multi-Arch</strong> stanza values set in the <strong>debian/control</strong> file.</p></div>
<div class="paragraph"><p>In many cases, the <strong>debmake</strong> command makes good guess for <em>type</em> from <em>binarypackage</em>.  If <em>type</em> is not obvious, <em>type</em> is set to <strong>bin</strong>.  For example, <strong>libfoo</strong> sets <em>type</em> to <strong>lib</strong>, and <strong>font-bar</strong> sets <em>type</em> to <strong>data</strong>, &#8230;</p></div>
<div class="paragraph"><p>If the source tree contents does not match settings for <em>type</em>, <strong>debmake</strong> warns you.</p></div>
</dd>
<dt class="hdlist1">
<strong>-e</strong> <em>foo@example.org</em>, <strong>--email</strong> <em>foo@example.org</em>
</dt>
<dd>
<p>
set e-mail address.
</p>
<div class="paragraph"><p>The default is taken from the value of the environment variable <strong>$DEBEMAIL</strong>.</p></div>
</dd>
<dt class="hdlist1">
<strong>-f</strong> "<em>firstname lastname</em>", <strong>--fullname</strong> "<em>firstname lastname</em>"
</dt>
<dd>
<p>
set the fullname.
</p>
<div class="paragraph"><p>The default is taken from the value of the environment variable <strong>$DEBFULLNAME</strong>.</p></div>
</dd>
<dt class="hdlist1">
<strong>-i</strong> "<em>buildtool</em>", <strong>--invoke</strong> "<em>buildtool</em>"
</dt>
<dd>
<p>
invoke "<em>buildtool</em>" at the end of execution.  "<em>buildtool</em>" may be "<strong>dpkg-buildpackage</strong>", "<strong>debuild</strong>", "<strong>pdebuild</strong>", "<strong>pdebuild  --pbuilder cowbuilder</strong>", etc..
</p>
<div class="paragraph"><p>The default is not to execute any program.</p></div>
</dd>
<dt class="hdlist1">
<strong>-j</strong>, <strong>--judge</strong>
</dt>
<dd>
<p>
run <strong>dpkg-depcheck</strong> to judge build dependencies and identify file paths.  Log files are in the parent directory.
</p>
<div class="ulist"><ul>
<li>
<p>
<em>package</em><strong>.build-dep.log</strong>: Log file for <strong>dpkg-depcheck</strong>.
</p>
</li>
<li>
<p>
<em>package</em><strong>.install.log</strong>: Log file recording files in the <strong>debian/tmp</strong> directory.
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<strong>-l</strong> "<em>license_file,&#8230;</em>", <strong>--license</strong> "<em>license_file,&#8230;</em>"
</dt>
<dd>
<p>
add formatted license text to the end of the <strong>debian/copyright</strong> file holding license scan results
</p>
<div class="paragraph"><p>The default is add <strong>COPYING</strong> and <strong>LICENSE</strong> and <em>license_file</em> needs to list only the additional file names all separated by "<strong>,</strong>".</p></div>
</dd>
<dt class="hdlist1">
<strong>-m</strong>, <strong>--monoarch</strong>
</dt>
<dd>
<p>
force packages to be non-multiarch.
</p>
</dd>
<dt class="hdlist1">
<strong>-o</strong> <em>file</em>, <strong>--option</strong> <em>file</em>
</dt>
<dd>
<p>
read optional parameters from file. (This is not for everyday use.)
</p>
<div class="paragraph"><p>The <em>file</em> is sourced as the Python3 code at the end of <strong>para.py</strong>.  For example, the package description can be specified by the following file.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>para['desc'] = 'program short description'
para['desc_long'] = '''\
 program long description which you wish to include.
 .
 Empty line is space + .
 You keep going on ...
'''</code></pre>
</div></div>
</dd>
</dl></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>-q</strong>, <strong>--quitearly</strong>
</dt>
<dd>
<p>
quit early before creating files in the <strong>debian/</strong> directory.
</p>
</dd>
<dt class="hdlist1">
<strong>-s</strong>, <strong>--spec</strong>
</dt>
<dd>
<p>
use upstream spec (setup.py for Python, etc.) for the package description.
</p>
</dd>
<dt class="hdlist1">
<strong>-v</strong>, <strong>--version</strong>
</dt>
<dd>
<p>
show version information.
</p>
</dd>
<dt class="hdlist1">
<strong>-w</strong> "<em>addon,&#8230;</em>", <strong>--with</strong> "<em>addon,&#8230;</em>"
</dt>
<dd>
<p>
add extra arguments to the <strong>--with</strong> option of the <strong>dh</strong>(1) command as <em>addon</em> in <strong>debian/rules</strong>.
</p>
<div class="paragraph"><p>The <em>addon</em> values are listed all separated by "<strong>,</strong>", e.g., <strong>-w "python2,autoreconf"</strong>.</p></div>
<div class="paragraph"><p>For  Autotools based packages, setting <strong>autoreconf</strong> as <em>addon</em> forces to run "<strong>autoreconf -i -v -f</strong>" for every package building.  Otherwise, <strong>autotools-dev</strong> as <em>addon</em> is used as default.</p></div>
<div class="paragraph"><p>For Autotools based packages, if they install Python programs, <strong>python2</strong> as addon is needed for packages with <strong>compat &lt; 9</strong> since this is non-obvious.   But for <strong>setup.py</strong> based packages, <strong>python2</strong> as <em>addon</em> is not needed since this is obvious and it is automatically set for the <strong>dh</strong>(1) command by the <strong>debmake</strong> command when it is required.</p></div>
</dd>
<dt class="hdlist1">
<strong>-x</strong> <em>n</em>, <strong>--extra</strong> <em>n</em>
</dt>
<dd>
<p>
generate extra configuration files as templates.
</p>
<div class="paragraph"><p>The number <em>n</em> changes which configuration templates are generated.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>-x0</strong>: bare minimum configuration files. (default if these files exist already)
</p>
</li>
<li>
<p>
<strong>-x1</strong>: ,, + desirable configuration files. (default for new packages)
</p>
</li>
<li>
<p>
<strong>-x2</strong>: ,, + interesting configuration files. (recommended for experts, multi binary aware)
</p>
</li>
<li>
<p>
<strong>-x3</strong>:  ,,  + unusual configuration template files with the extra <strong>.ex</strong> suffix to ease their removal. (recommended for new users) To use these as configuration files, rename their file names into ones without the <strong>.ex</strong> suffix.
</p>
</li>
<li>
<p>
<strong>-x4</strong>: ,, + copyright file examples.
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<strong>-y</strong>, <strong>--yes</strong>
</dt>
<dd>
<p>
force "yes" for all prompts. (without option: "ask [Y/n]"; doubled option: force "no")
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect3">
<h4 id="_examples">EXAMPLES</h4>
<div class="paragraph"><p>For  a  well  behaving  source, you can build a good-for-local-use installable single Debian binary package easily with one command.  Test install of such a package
generated in this way offers a good alternative to traditional "<strong>make install</strong>" to the <strong>/usr/local</strong> directory since the Debian package can be  removed  cleanly  by  the
"<strong>dpkg -P</strong> <em>&#8230;</em>" command. Here are some examples of how to build such test packages. (These should work in most cases.  If the <strong>-d</strong> does not work, try <strong>-t</strong> instead.)</p></div>
<div class="paragraph"><p>For a typical C program source tree packaged with autoconf/automake:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>debmake -d -i debuild</strong>
</p>
</li>
</ul></div>
<div class="paragraph"><p>For a typical python module source tree:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>debmake -s -d -b":python" -i debuild</strong>
</p>
</li>
</ul></div>
<div class="paragraph"><p>For a typical python module in the <em>package-version</em><strong>.tar.gz</strong> archive:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>debmake -s -a <em>package-version</em>.tar.gz -b":python" -i debuild</strong>
</p>
</li>
</ul></div>
<div class="paragraph"><p>For a typical perl module in the <em>Package-version</em><strong>.tar.gz</strong> archive:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>debmake -a <em>Package-version</em>.tar.gz -b":perl" -i debuild</strong>
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_helper_packages">HELPER PACKAGES</h4>
<div class="paragraph"><p>Packaging may require installation of some additional specialty helper packages.</p></div>
<div class="ulist"><ul>
<li>
<p>
Python3 program may require the <strong>dh-python</strong> package.
</p>
</li>
<li>
<p>
Autotools (Autoconf + Automake) build system may require <strong>autotools-dev</strong> or <strong>dh-autoreconf</strong> package.
</p>
</li>
<li>
<p>
Ruby program may require the <strong>gem2deb</strong> package.
</p>
</li>
<li>
<p>
Java program may require the <strong>javahelper</strong> package.
</p>
</li>
<li>
<p>
Gnome programs may require the <strong>gobject-introspection</strong> package.
</p>
</li>
<li>
<p>
etc.
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_caveat">CAVEAT</h4>
<div class="paragraph"><p>There  are some limitations for what characters may be used as a part of the Debian package.  The most notable limitation is the prohibition of uppercase letters in the package name.  Here is the summary in the regular expression.</p></div>
<div class="ulist"><ul>
<li>
<p>
Upstream package name (<strong>-p</strong>): [-+.a-z0-9]{2,}
</p>
</li>
<li>
<p>
Binary package name (<strong>-b</strong>): [-+.a-z0-9]{2,}
</p>
</li>
<li>
<p>
Upstream version (<strong>-u</strong>): [0-9][-+.:~a-z0-9A-Z]*
</p>
</li>
<li>
<p>
Debian revision (<strong>-r</strong>): [0-9][+.~a-z0-9A-Z]*
</p>
</li>
</ul></div>
<div class="paragraph"><p>See the exact definition in <a href="http://www.debian.org/doc/debian-policy/ch-controlfields.html">Chapter 5 - Control files and their fields</a> of &#8220;Debian Policy Manual&#8221;.</p></div>
</div>
<div class="sect3">
<h4 id="_debug">DEBUG</h4>
<div class="paragraph"><p>The character set in the environ variable <strong>$DEBUG</strong> determines the logging output level.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>p</strong>: list all parameters
</p>
</li>
<li>
<p>
<strong>d</strong>: list all binary package parameters
</p>
</li>
<li>
<p>
<strong>f</strong>: copyright scanner input filename
</p>
</li>
<li>
<p>
<strong>i</strong>: copyright scanner input line
</p>
</li>
<li>
<p>
<strong>o</strong>: line outside of the copyright and license sections
</p>
</li>
<li>
<p>
<strong>c</strong>: line inside of the copyright section
</p>
</li>
<li>
<p>
<strong>l</strong>: line inside of the license section
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_author">AUTHOR</h4>
<div class="paragraph"><p>Copyright  2013 Osamu Aoki &lt;<a href="mailto:osamu@debian.org">osamu@debian.org</a>&gt;</p></div>
</div>
<div class="sect3">
<h4 id="_license">LICENSE</h4>
<div class="paragraph"><p>MIT License</p></div>
</div>
<div class="sect3">
<h4 id="_see_also">SEE ALSO</h4>
<div class="paragraph"><p>See also <strong>debhelper</strong>(7), <strong>dpkg-buildpackage</strong>(1) <strong>debuild</strong>(1) and <strong>pdebuild</strong>(1) manpages and files in /usr/share/doc/debmake/.</p></div>
<div class="paragraph"><p>Learn basics of Debian packaging with the &#8220;Debian New Maintainers' Guide&#8221; at <a href="http://www.debian.org/doc/manuals/maint-guide/">http://www.debian.org/doc/manuals/maint-guide/</a> or with the <strong>maint-guide</strong> package.</p></div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-04-02 18:33:25 JST
</div>
</div>
</body>
</html>
